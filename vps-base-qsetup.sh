#!/bin/bash

# ==========================================================================
#  vps-base-qsetup - –ë–∞–∑–æ–≤–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞ VPS —Å—ä—Ä–≤—ä—Ä (–ª–æ–∫–∞–ª–Ω–æ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ)
# --------------------------------------------------------------------------
#  –í–µ—Ä—Å–∏—è: 1.0
#  –î–∞—Ç–∞: 2025-06-19
#  –ê–≤—Ç–æ—Ä: Ilko Yordanov / NetGalaxy
# ==========================================================================
#
#  –¢–æ–∑–∏ —Å–∫—Ä–∏–ø—Ç –∏–∑–≤—ä—Ä—à–≤–∞ –Ω–∞—á–∞–ª–Ω–∞, –±–µ–∑–æ–ø–∞—Å–Ω–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–∞–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞
#  VPS —Å—ä—Ä–≤—ä—Ä. –ò–∑–ø—ä–ª–Ω—è–≤–∞ —Å–µ –¥–∏—Ä–µ–∫—Ç–Ω–æ –Ω–∞ —Å—ä—Ä–≤—ä—Ä–∞, –Ω–µ –∏–∑–∏—Å–∫–≤–∞ SSH –∫—ä–º –¥—Ä—É–≥–∏ –º–∞—à–∏–Ω–∏.
#
#  –ï—Ç–∞–ø–∏:
#    1. –í—ä–≤–µ–∂–¥–∞–Ω–µ –Ω–∞ –Ω—É–∂–Ω–∞—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
#    2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç
#    3. –ü–æ—Ç–≤—ä—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
#    4. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞ —Å—ä—Ä–≤—ä—Ä–∞
# ==========================================================================

# === –ü–û–ú–û–©–ù–ê –ò–ù–§–û–†–ú–ê–¶–ò–Ø ===================================================
show_help() {
  echo "–ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ: vps-base-qsetup.sh [–æ–ø—Ü–∏—è]"
  echo ""
  echo "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–∞–Ω–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–∞ –Ω–∞—á–∞–ª–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞ –ª–æ–∫–∞–ª–µ–Ω VPS —Å—ä—Ä–≤—ä—Ä."
  echo ""
  echo "–û–ø—Ü–∏–∏:"
  echo "  --version       –ü–æ–∫–∞–∑–≤–∞ –≤–µ—Ä—Å–∏—è—Ç–∞ –Ω–∞ —Å–∫—Ä–∏–ø—Ç–∞"
  echo "  --help          –ü–æ–∫–∞–∑–≤–∞ —Ç–∞–∑–∏ –ø–æ–º–æ—â"
}

# === –û–ë–†–ê–ë–û–¢–ö–ê –ù–ê –û–ü–¶–ò–ò ====================================================
if [[ $# -gt 0 ]]; then
  case "$1" in
    --version)
      echo "vps-base-qsetup –≤–µ—Ä—Å–∏—è 1.0 (19 —é–Ω–∏ 2025 –≥.)"
      exit 0
      ;;
    --help)
      show_help
      exit 0
      ;;
    *)
      echo "‚ùå –ù–µ—Ä–∞–∑–ø–æ–∑–Ω–∞—Ç–∞ –æ–ø—Ü–∏—è: $1"
      show_help
      exit 1
      ;;
  esac
fi

# === –ü–û–ö–ê–ó–í–ê–ù–ï –ù–ê –ó–ê–ì–õ–ê–í–ò–ï–¢–û ===============================================
echo ""
echo ""
echo -e "\e[32m=========================================="
echo -e " –ù–ê–ß–ê–õ–ù–ê –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ù–ê –û–¢–î–ê–õ–ï–ß–ï–ù –°–™–†–í–™–†"
echo -e "==========================================\e[0m"
echo ""

# === –ì–õ–û–ë–ê–õ–ù–ò –ü–†–û–ú–ï–ù–õ–ò–í–ò ===================================================
SERVER_IP="$(ip route get 1.1.1.1 | grep -oP 'src \K[\d.]+')"
SSH_PORT="22"
FQDN=""
ADMIN_USER=""
CONFIRMATION=""
FIREWALL_SYSTEM="unknown"

# === –°–¢–™–ü–ö–ê 1: –í–™–í–ï–ñ–î–ê–ù–ï –ù–ê –ò–ù–§–û–†–ú–ê–¶–ò–Ø –ó–ê –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø–¢–ê ====================
echo "== –°–¢–™–ü–ö–ê 1: –í–™–í–ï–ñ–î–ê–ù–ï –ù–ê –ò–ù–§–û–†–ú–ê–¶–ò–Ø –ó–ê –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø–¢–ê =="
echo ""

# --- [1] –í–™–í–ï–ñ–î–ê–ù–ï –ò –ü–†–û–í–ï–†–ö–ê –ù–ê IP –ê–î–†–ï–° –ù–ê –°–™–†–í–™–†–ê ------------------------
echo "[1] –í–™–í–ï–ñ–î–ê–ù–ï –ò –ü–†–û–í–ï–†–ö–ê –ù–ê IP –ê–î–†–ï–° –ù–ê –°–™–†–í–™–†–ê..."
echo "-------------------------------------------------------------------------"
echo ""

while true; do
  printf "üåê –í—ä–≤–µ–¥–µ—Ç–µ –ø—É–±–ª–∏—á–Ω–∏—è IP –∞–¥—Ä–µ—Å –Ω–∞ —Å—ä—Ä–≤—ä—Ä–∞ (–∏–ª–∏ 'q' –∑–∞ –∏–∑—Ö–æ–¥): "
  read SERVER_IP

  if [[ "$SERVER_IP" == "q" || "$SERVER_IP" == "Q" ]]; then
    echo "‚ùé –°–∫—Ä–∏–ø—Ç—ä—Ç –±–µ—à–µ –ø—Ä–µ–∫—Ä–∞—Ç–µ–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è."
    exit 0
  fi

  if [[ "$SERVER_IP" =~ ^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+$ ]]; then
    break
  else
    echo "‚ùå –ù–µ–≤–∞–ª–∏–¥–µ–Ω IP –∞–¥—Ä–µ—Å. –ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ –≤–∞–ª–∏–¥–µ–Ω IPv4 –∞–¥—Ä–µ—Å (–Ω–∞–ø—Ä. 192.168.1.100)."
  fi
done

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ—Ç–∫—Ä–∏–≤–∞–Ω–µ –Ω–∞ —Ç–µ–∫—É—â–∏—è –ø—É–±–ª–∏—á–µ–Ω IP
ACTUAL_IP=$(curl -s ifconfig.me)

if [[ "$ACTUAL_IP" != "$SERVER_IP" ]]; then
  echo ""
  echo "üö´ –°–∫—Ä–∏–ø—Ç—ä—Ç –Ω–µ –µ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω –Ω–∞ –ø—Ä–∞–≤–∏–ª–Ω–∞—Ç–∞ –º–∞—à–∏–Ω–∞!"
  echo "üëâ –í—ä–≤–µ–¥–µ–Ω IP –∞–¥—Ä–µ—Å: $SERVER_IP"
  echo "üìç –û—Ç–∫—Ä–∏—Ç IP –∞–¥—Ä–µ—Å:  $ACTUAL_IP"
  echo "‚õî –ü—Ä–µ–∫—Ä–∞—Ç—è–≤–∞–Ω–µ –Ω–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ—Ç–æ."
  exit 1
fi

echo "‚úÖ –ü–æ—Ç–≤—ä—Ä–¥–µ–Ω–æ: —Å–∫—Ä–∏–ø—Ç—ä—Ç –µ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω –Ω–∞ —Å—ä—Ä–≤—ä—Ä–∞ —Å IP $SERVER_IP."
echo ""
echo ""

# --- [2] –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ù–ê –°–™–†–í–™–†–ï–ù –î–û–ú–ï–ô–ù (FQDN) -----------------------------
echo "[2] –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ù–ê –°–™–†–í–™–†–ï–ù –î–û–ú–ï–ô–ù (FQDN)..."
echo "-------------------------------------------------------------------------"
echo ""

while true; do
  printf "üëâ –í—ä–≤–µ–¥–µ—Ç–µ –¥–æ–º–µ–π–Ω–∞ –Ω–∞ —Å—ä—Ä–≤—ä—Ä–∞ (FQDN) –∏–ª–∏ 'q' –∑–∞ –∏–∑—Ö–æ–¥: "
  read FQDN

  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –ø—Ä–µ–∫—Ä–∞—Ç—è–≤–∞–Ω–µ –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è
  if [[ "$FQDN" == "q" || "$FQDN" == "Q" ]]; then
    echo "‚ùé –°–∫—Ä–∏–ø—Ç—ä—Ç –±–µ—à–µ –ø—Ä–µ–∫—Ä–∞—Ç–µ–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è."
    exit 0
  fi

  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª–∏ –≤—Ö–æ–¥—ä—Ç –µ –ø—Ä–∞–∑–µ–Ω
  if [[ -z "$FQDN" ]]; then
    echo "‚ùå –î–æ–º–µ–π–Ω—ä—Ç –Ω–µ –º–æ–∂–µ –¥–∞ –±—ä–¥–µ –ø—Ä–∞–∑–µ–Ω. –û–ø–∏—Ç–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ."
    continue
  fi

  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –≤–∞–ª–∏–¥–µ–Ω —Ñ–æ—Ä–º–∞—Ç –Ω–∞ –¥–æ–º–µ–π–Ω (–Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–∞ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞–Ω–µ)
  if [[ ! "$FQDN" =~ ^([a-zA-Z0-9][-a-zA-Z0-9]*\.)+[a-zA-Z]{2,}$ ]]; then
    echo "‚ùå –ù–µ–≤–∞–ª–∏–¥–µ–Ω —Ñ–æ—Ä–º–∞—Ç –Ω–∞ –¥–æ–º–µ–π–Ω. –ü—Ä–∏–º–µ—Ä –∑–∞ –≤–∞–ª–∏–¥–µ–Ω: example.com"
    continue
  fi

  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª–∏ –¥–æ–º–µ–π–Ω—ä—Ç —Ä–µ–∑–æ–ª–≤–∏—Ä–∞ (–ø–æ –∏–∑–±–æ—Ä)
 if ! getent hosts "$FQDN" >/dev/null; then
   echo "‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –î–æ–º–µ–π–Ω—ä—Ç '$FQDN' –Ω–µ —Ä–µ–∑–æ–ª–≤–∏—Ä–∞ –≤ –º–æ–º–µ–Ω—Ç–∞."
   while true; do
     printf "‚ùì –ò—Å–∫–∞—Ç–µ –ª–∏ –¥–∞ –ø—Ä–æ–¥—ä–ª–∂–∏—Ç–µ —Å —Ç–æ–∑–∏ –¥–æ–º–µ–π–Ω? (y / n): "
     read -r confirm
     if [[ "$confirm" =~ ^[Yy]$ ]]; then
       break  # –ø—Ä–æ–¥—ä–ª–∂–∞–≤–∞–º–µ —Å—ä—Å —Å—ä—â–∏—è –¥–æ–º–µ–π–Ω
     elif [[ "$confirm" =~ ^[Nn]$ || -z "$confirm" ]]; then
       continue 2  # –≤—Ä—ä—â–∞–º–µ —Å–µ –∫—ä–º –≤—ä–≤–µ–∂–¥–∞–Ω–µ—Ç–æ –Ω–∞ –Ω–æ–≤ –¥–æ–º–µ–π–Ω
     else
       echo "‚ùå –ú–æ–ª—è, –æ—Ç–≥–æ–≤–æ—Ä–µ—Ç–µ —Å 'y' –∑–∞ –¥–∞ –ø—Ä–æ–¥—ä–ª–∂–∏—Ç–µ –∏–ª–∏ 'n' –∑–∞ –Ω–æ–≤ –¥–æ–º–µ–π–Ω."
     fi
   done
 fi

  break
done
echo ""
echo ""

# --- [3] –û–ü–†–ï–î–ï–õ–Ø–ù–ï –ù–ê SSH –ü–û–†–¢ -----------------------------------------------
echo "[3] –û–ü–†–ï–î–ï–õ–Ø–ù–ï –ù–ê SSH –ü–û–†–¢..."
echo "-------------------------------------------------------------------------"
echo ""

# –û—Ç–∫—Ä–∏–≤–∞–Ω–µ –Ω–∞ —Ç–µ–∫—É—â–∏—è SSH –ø–æ—Ä—Ç (–∏–ª–∏ –∑–∞–¥–∞–≤–∞–Ω–µ –Ω–∞ 22, –∞–∫–æ –Ω–µ —Å–µ –æ—Ç–∫—Ä–∏–µ)
CURRENT_SSH_PORT=$(ss -tlpn 2>/dev/null | grep sshd | awk -F: '/LISTEN/ {print $2}' | awk '{print $1}' | head -n 1)
CURRENT_SSH_PORT="${CURRENT_SSH_PORT:-22}"

while true; do
  printf "üëâ –í –º–æ–º–µ–Ω—Ç–∞ –∏–∑–ø–æ–ª–∑–≤–∞—Ç–µ SSH –ø–æ—Ä—Ç %s.\n" "$CURRENT_SSH_PORT"
  echo "   –í—ä–≤–µ–¥–µ—Ç–µ –Ω–æ–≤ –ø–æ—Ä—Ç, –∞–∫–æ –∂–µ–ª–∞–µ—Ç–µ –¥–∞ –≥–æ –ø—Ä–æ–º–µ–Ω–∏—Ç–µ,"
  echo "   –∏–ª–∏ –Ω–∞—Ç–∏—Å–Ω–µ—Ç–µ Enter –±–µ–∑ –≤—ä–≤–µ–∂–¥–∞–Ω–µ –∑–∞ –∑–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞—â–∏—è (–∏–ª–∏ 'q' –∑–∞ –ø—Ä–µ–∫—Ä–∞—Ç—è–≤–∞–Ω–µ):"
  printf "‚û§ SSH –ø–æ—Ä—Ç: "
  read -r SSH_PORT_INPUT

  if [[ "$SSH_PORT_INPUT" == "q" || "$SSH_PORT_INPUT" == "Q" ]]; then
    echo "‚ùé –°–∫—Ä–∏–ø—Ç—ä—Ç –±–µ—à–µ –ø—Ä–µ–∫—Ä–∞—Ç–µ–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è."
    exit 0

  elif [[ -z "$SSH_PORT_INPUT" ]]; then
    SSH_PORT="$CURRENT_SSH_PORT"
    echo "‚úÖ SSH –ø–æ—Ä—Ç—ä—Ç —â–µ –æ—Å—Ç–∞–Ω–µ: $SSH_PORT"
    break

  elif [[ "$SSH_PORT_INPUT" =~ ^[0-9]+$ ]] && (( SSH_PORT_INPUT >= 1024 && SSH_PORT_INPUT <= 65535 )); then
    SSH_PORT="$SSH_PORT_INPUT"
    echo "‚úÖ –ù–æ–≤ SSH –ø–æ—Ä—Ç —â–µ –±—ä–¥–µ: $SSH_PORT"
    break

  else
    echo "‚ùå –ù–µ–≤–∞–ª–∏–¥–µ–Ω –Ω–æ–º–µ—Ä –Ω–∞ –ø–æ—Ä—Ç. –î–æ–ø—É—Å—Ç–∏–º–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏: 1024‚Äì65535. –û–ø–∏—Ç–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ."
  fi
done
echo ""
echo ""

# --- [4] –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–°–ö–ò –ü–†–û–§–ò–õ -----------------------------------------------
echo "[4] –°–™–ó–î–ê–í–ê–ù–ï –ù–ê –ù–û–í –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–°–ö–ò –ü–†–û–§–ò–õ"
echo "-------------------------------------------------------------------------"
echo "üîê –ü–æ —Å—ä–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç, root –¥–æ—Å—Ç—ä–ø—ä—Ç —á—Ä–µ–∑ SSH —â–µ –±—ä–¥–µ –∑–∞–±—Ä–∞–Ω–µ–Ω."
echo "‚úÖ –©–µ —Å—ä–∑–¥–∞–¥–µ–º –Ω–æ–≤ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª —Å root –ø—Ä–∞–≤–∞ –∑–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞ —Ä–∞–±–æ—Ç–∞."
echo ""

while true; do
  printf "üëâ –í—ä–≤–µ–¥–µ—Ç–µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–æ –∏–º–µ –∑–∞ –Ω–æ–≤–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä (–º–∏–Ω. 3 —Å–∏–º–≤–æ–ª–∞ –∏–ª–∏ q –∑–∞ –∏–∑—Ö–æ–¥): "
  read ADMIN_USER

  if [[ "$ADMIN_USER" == "q" || "$ADMIN_USER" == "Q" ]]; then
    echo "‚ùé –°–∫—Ä–∏–ø—Ç—ä—Ç –±–µ—à–µ –ø—Ä–µ–∫—Ä–∞—Ç–µ–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è."
    exit 0
  fi

  if [[ -z "$ADMIN_USER" ]]; then
    echo "‚ùå –ü–æ–ª–µ—Ç–æ –∑–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–æ—Ç–æ –∏–º–µ –Ω–µ –º–æ–∂–µ –¥–∞ –±—ä–¥–µ –ø—Ä–∞–∑–Ω–æ."
    continue
  fi

  if [[ ${#ADMIN_USER} -lt 3 ]]; then
    echo "‚ùå –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–æ—Ç–æ –∏–º–µ —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–µ –ø–æ–Ω–µ 3 —Å–∏–º–≤–æ–ª–∞."
    continue
  fi

  if [[ ! "$ADMIN_USER" =~ ^[a-z_][a-z0-9_-]*$ ]]; then
    echo "‚ùå –ù–µ–≤–∞–ª–∏–¥–Ω–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–æ –∏–º–µ. –†–∞–∑—Ä–µ—à–µ–Ω–∏ —Å–∞ —Å–∞–º–æ –º–∞–ª–∫–∏ –±—É–∫–≤–∏, —Ü–∏—Ñ—Ä–∏, '-', '_' –∏ –¥–∞ –Ω–µ –∑–∞–ø–æ—á–≤–∞ —Å —Ü–∏—Ñ—Ä–∞."
    continue
  fi

  if id "$ADMIN_USER" &>/dev/null; then
    echo "‚ö†Ô∏è –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç '$ADMIN_USER' –≤–µ—á–µ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞. –ò–∑–±–µ—Ä–µ—Ç–µ –¥—Ä—É–≥–æ –∏–º–µ."
    continue
  fi

  break
done

echo "üõ°Ô∏è –ü–∞—Ä–æ–ª–∞—Ç–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ –æ—Ç–≥–æ–≤–∞—Ä—è –Ω–∞ —Å–ª–µ–¥–Ω–∏—Ç–µ —É—Å–ª–æ–≤–∏—è:"
echo "   - –ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–∞"
echo "   - –ü–æ–Ω–µ –µ–¥–Ω–∞ –ª–∞—Ç–∏–Ω—Å–∫–∞ –º–∞–ª–∫–∞ –±—É–∫–≤–∞ (a-z)"
echo "   - –ü–æ–Ω–µ –µ–¥–Ω–∞ –ª–∞—Ç–∏–Ω—Å–∫–∞ –≥–ª–∞–≤–Ω–∞ –±—É–∫–≤–∞ (A-Z)"
echo "   - –ü–æ–Ω–µ –µ–¥–Ω–∞ —Ü–∏—Ñ—Ä–∞ (0-9)"
echo "‚ùó –í–Ω–∏–º–∞–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –Ω–∞ –∫–∞–∫—ä–≤ –µ–∑–∏–∫ –≤—ä–≤–µ–∂–¥–∞—Ç–µ, –∞–∫–æ –∏–∑–ø–æ–ª–∑–≤–∞—Ç–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∏ –±—É–∫–≤–∏ (–Ω–∞–ø—Ä. –∫–∏—Ä–∏–ª–∏—Ü–∞)"
echo ""

while true; do
  printf "üîë –í—ä–≤–µ–¥–µ—Ç–µ –ø–∞—Ä–æ–ª–∞ –∑–∞ %s: " "$ADMIN_USER"
  read -s PASSWORD_1
  echo

  if [[ -z "$PASSWORD_1" ]]; then
    echo "‚ùå –ü–∞—Ä–æ–ª–∞—Ç–∞ –Ω–µ –º–æ–∂–µ –¥–∞ –µ –ø—Ä–∞–∑–Ω–∞."
    continue
  fi

  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –¥—ä–ª–∂–∏–Ω–∞, –º–∞–ª–∫–∞ –±—É–∫–≤–∞, –≥–ª–∞–≤–Ω–∞ –±—É–∫–≤–∞ –∏ —Ü–∏—Ñ—Ä–∞
  if (( ${#PASSWORD_1} < 8 )) || \
     ! [[ "$PASSWORD_1" =~ [a-z] ]] || \
     ! [[ "$PASSWORD_1" =~ [A-Z] ]] || \
     ! [[ "$PASSWORD_1" =~ [0-9] ]]; then
    echo "‚ùå –ü–∞—Ä–æ–ª–∞—Ç–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å—ä–¥—ä—Ä–∂–∞ –ø–æ–Ω–µ 8 —Å–∏–º–≤–æ–ª–∞, –≤–∫–ª—é—á–∏—Ç–µ–ª–Ω–æ –º–∞–ª–∫–∞ –∏ –≥–ª–∞–≤–Ω–∞ –ª–∞—Ç–∏–Ω—Å–∫–∞ –±—É–∫–≤–∞, –∏ —Ü–∏—Ñ—Ä–∞."
    continue
  fi

  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –±—É–∫–≤–∏ –∏–∑–≤—ä–Ω –ª–∞—Ç–∏–Ω–∏—Ü–∞—Ç–∞
  if LC_ALL=C grep -q '[^ -~]' <<< "$PASSWORD_1"; then
    echo "‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –í –ø–∞—Ä–æ–ª–∞—Ç–∞ —Å–∞ –æ—Ç–∫—Ä–∏—Ç–∏ –±—É–∫–≤–∏ –∏–ª–∏ –∑–Ω–∞—Ü–∏, –∫–æ–∏—Ç–æ –Ω–µ —Å–∞ —á–∞—Å—Ç –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—Ç–∞ –ª–∞—Ç–∏–Ω–∏—Ü–∞."
    echo "   –¢–æ–≤–∞ –º–æ–∂–µ –¥–∞ —Å–µ –¥—ä–ª–∂–∏ –Ω–∞ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ –∫–∏—Ä–∏–ª–∏—Ü–∞ –∏–ª–∏ –¥—Ä—É–≥–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏ —Å–∏–º–≤–æ–ª–∏."
    while true; do
      printf "‚ùì –ò—Å–∫–∞—Ç–µ –ª–∏ –¥–∞ –ø—Ä–æ–¥—ä–ª–∂–∏—Ç–µ —Å —Ç–∞–∑–∏ –ø–∞—Ä–æ–ª–∞? (y / n): "
      read -r confirm_charset
      if [[ "$confirm_charset" =~ ^[Yy]$ ]]; then
        break
      elif [[ "$confirm_charset" =~ ^[Nn]$ || -z "$confirm_charset" ]]; then
        continue 2  # –≤—ä–≤–µ–¥–∏ –Ω–æ–≤–∞ –ø–∞—Ä–æ–ª–∞
      else
        echo "‚ùå –ú–æ–ª—è, –æ—Ç–≥–æ–≤–æ—Ä–µ—Ç–µ —Å 'y' –∏–ª–∏ 'n'."
      fi
    done
  fi

  # –ü–æ–≤—Ç–æ—Ä–Ω–æ –≤—ä–≤–µ–∂–¥–∞–Ω–µ
  printf "üîë –ü–æ–≤—Ç–æ—Ä–µ—Ç–µ –ø–∞—Ä–æ–ª–∞—Ç–∞: "
  read -s PASSWORD_2
  echo

  if [[ "$PASSWORD_1" != "$PASSWORD_2" ]]; then
    echo "‚ùå –ü–∞—Ä–æ–ª–∏—Ç–µ –Ω–µ —Å—ä–≤–ø–∞–¥–∞—Ç. –û–ø–∏—Ç–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ."
  else
    break
  fi
done
echo ""
echo ""

# --- [5] –ü–†–û–í–ï–†–ö–ê –ó–ê FIREWALL –°–ò–°–¢–ï–ú–ê --------------------------------------------
echo "[5] –ü–†–û–í–ï–†–ö–ê –ó–ê FIREWALL –°–ò–°–¢–ï–ú–ê..."
echo "-------------------------------------------------------------------------"
echo ""

FIREWALL_SYSTEM="none"
FIREWALL_ACTIVE="no"

# –ó–∞—Å–∏—á–∞–Ω–µ –Ω–∞ –Ω–∞–ª–∏—á–Ω–∞ –∑–∞—â–∏—Ç–Ω–∞ —Å—Ç–µ–Ω–∞
if command -v ufw >/dev/null 2>&1; then
  FIREWALL_SYSTEM="ufw"
elif command -v firewalld >/dev/null 2>&1; then
  FIREWALL_SYSTEM="firewalld"
elif command -v iptables >/dev/null 2>&1; then
  FIREWALL_SYSTEM="iptables"
fi

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω–∏—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
case "$FIREWALL_SYSTEM" in
  "ufw")
    echo "üõ°Ô∏è  –ó–∞—Å–µ—á–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∑–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –∑–∞—â–∏—Ç–Ω–∞—Ç–∞ —Å—Ç–µ–Ω–∞: UFW"
    if sudo ufw status | grep -iq "inactive"; then
      echo "‚ÑπÔ∏è  UFW –µ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω, –Ω–æ –Ω–µ –µ –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω."
      echo "‚ö†Ô∏è  –í–∞—à–∞—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–∑–ø–æ–ª–∞–≥–∞ —Å –Ω–µ–∞–∫—Ç–∏–≤–∏—Ä–∞–Ω–∞ –∑–∞—â–∏—Ç–Ω–∞ —Å—Ç–µ–Ω–∞ **UFW**, –∫–æ—è—Ç–æ –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∞ –∑–∞ —Å—ä—Ä–≤—ä—Ä–∏—Ç–µ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ç–∞ NetGalaxy."
      while true; do
        printf "‚úîÔ∏è –ñ–µ–ª–∞–µ—Ç–µ –ª–∏ –¥–∞ —è –∞–∫—Ç–∏–≤–∏—Ä–∞—Ç–µ? (y –∑–∞ —Å—ä–≥–ª–∞—Å–∏–µ, q –∑–∞ –∏–∑—Ö–æ–¥): "
        read confirm
        case "$confirm" in
          [Yy]*) break ;;
          [Qq]*) echo "‚ùé –°–∫—Ä–∏–ø—Ç—ä—Ç –±–µ—à–µ –ø—Ä–µ–∫—Ä–∞—Ç–µ–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è."; exit 0 ;;
          *) echo "‚ùå –ú–æ–ª—è, –æ—Ç–≥–æ–≤–æ—Ä–µ—Ç–µ —Å 'y' –∏–ª–∏ 'q'." ;;
        esac
      done
    else
      echo "‚úÖ –ó–∞—â–∏—Ç–Ω–∞—Ç–∞ —Å—Ç–µ–Ω–∞ **UFW** –µ –∞–∫—Ç–∏–≤–Ω–∞."
      echo ""
      echo "üìñ –ó–∞—Å–µ—á–µ–Ω–∏ –æ—Ç–≤–æ—Ä–µ–Ω–∏ –ø–æ—Ä—Ç–æ–≤–µ –≤ UFW:"
      sudo ufw status numbered 2>/dev/null | sed 's/^/    /'
    fi
    ;;

  "none")
    echo "‚ö†Ô∏è  –í –º–æ–º–µ–Ω—Ç–∞ –≤–∞—à–∞—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ **–Ω–µ –∏–∑–ø–æ–ª–∑–≤–∞ –∑–∞—â–∏—Ç–Ω–∞ —Å—Ç–µ–Ω–∞**."
    echo "üõ°Ô∏è  –í –±—ä–¥–µ—â–µ —â–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç–µ –∑–∞—â–∏—Ç–Ω–∞ —Å—Ç–µ–Ω–∞ **UFW**, –∫–æ—è—Ç–æ –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∞ –∑–∞ —Å—ä—Ä–≤—ä—Ä–∏—Ç–µ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ç–∞ NetGalaxy."
    while true; do
      printf "‚úîÔ∏è –ñ–µ–ª–∞–µ—Ç–µ –ª–∏ –¥–∞ –ø—Ä–æ–¥—ä–ª–∂–∏—Ç–µ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–Ω–µ –Ω–∞ UFW? (y –∑–∞ —Å—ä–≥–ª–∞—Å–∏–µ, q –∑–∞ –∏–∑—Ö–æ–¥): "
      read confirm
      case "$confirm" in
        [Yy]*) break ;;
        [Qq]*) echo "‚ùé –°–∫—Ä–∏–ø—Ç—ä—Ç –±–µ—à–µ –ø—Ä–µ–∫—Ä–∞—Ç–µ–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è."; exit 0 ;;
        *) echo "‚ùå –ú–æ–ª—è, –æ—Ç–≥–æ–≤–æ—Ä–µ—Ç–µ —Å 'y' –∏–ª–∏ 'q'." ;;
      esac
    done
    ;;

  *)
    echo "üîÅ –í –º–æ–º–µ–Ω—Ç–∞ –∏–∑–ø–æ–ª–∑–≤–∞—Ç–µ –∑–∞—â–∏—Ç–Ω–∞ —Å—Ç–µ–Ω–∞: $FIREWALL_SYSTEM"
    echo "üìå –í –±—ä–¥–µ—â–µ —Ç–∞–∑–∏ —Å–∏—Å—Ç–µ–º–∞ —â–µ –±—ä–¥–µ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–∞–Ω–∞ –∏ —â–µ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ **UFW**, –∫–æ—è—Ç–æ –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∞ –∑–∞ —Å—ä—Ä–≤—ä—Ä–∏—Ç–µ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ç–∞ NetGalaxy."
    echo ""
    echo "üìñ –ó–∞—Å–µ—á–µ–Ω–∏ –æ—Ç–≤–æ—Ä–µ–Ω–∏ –ø–æ—Ä—Ç–æ–≤–µ:"
    ss -tuln | awk 'NR>1 {print $5}' | cut -d: -f2 | sort -nu | sed 's/^/  - /'
    while true; do
      printf "‚úîÔ∏è –ñ–µ–ª–∞–µ—Ç–µ –ª–∏ –¥–∞ –ø—Ä–æ–¥—ä–ª–∂–∏—Ç–µ —Å –ø—Ä–µ–º–∏–Ω–∞–≤–∞–Ω–µ –∫—ä–º UFW? (y –∑–∞ —Å—ä–≥–ª–∞—Å–∏–µ, q –∑–∞ –∏–∑—Ö–æ–¥): "
      read confirm
      case "$confirm" in
        [Yy]*) break ;;
        [Qq]*) echo "‚ùé –°–∫—Ä–∏–ø—Ç—ä—Ç –±–µ—à–µ –ø—Ä–µ–∫—Ä–∞—Ç–µ–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è."; exit 0 ;;
        *) echo "‚ùå –ú–æ–ª—è, –æ—Ç–≥–æ–≤–æ—Ä–µ—Ç–µ —Å 'y' –∏–ª–∏ 'q'." ;;
      esac
    done
    ;;
esac
echo ""
echo ""


# --- [5.1] –û–¢–í–û–†–ï–ù–ò –ü–û–†–¢–û–í–ï –ù–ê –ó–ê–©–ò–¢–ù–ê–¢–ê –°–¢–ï–ù–ê ------------------
echo "[5.1] –û–¢–í–û–†–ï–ù–ò –ü–û–†–¢–û–í–ï –ù–ê –ó–ê–©–ò–¢–ù–ê–¢–ê –°–¢–ï–ù–ê..."
echo "------------------------------------------------------------"
echo ""

# –ü–æ–∫–∞–∑–≤–∞–Ω–µ –Ω–∞ SSH –ø–æ—Ä—Ç–∞, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∑–∞—â–∏—Ç–Ω–∞—Ç–∞ —Å—Ç–µ–Ω–∞
if [[ -n "$SSH_PORT" ]]; then
  echo "üîê –ò–∑–±—Ä–∞–Ω –ø–æ—Ä—Ç –∑–∞ SSH –¥–æ—Å—Ç—ä–ø –¥–æ —Å—ä—Ä–≤—ä—Ä–∞: $SSH_PORT"
  echo ""
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª–∏ –∏–º–∞ –∞–∫—Ç–∏–≤–Ω–∞ –∑–∞—â–∏—Ç–Ω–∞ —Å—Ç–µ–Ω–∞ –∏ –∑–∞—Å–µ—á–µ–Ω–∏ –æ—Ç–≤–æ—Ä–µ–Ω–∏ –ø–æ—Ä—Ç–æ–≤–µ
OPEN_PORTS=()

if [[ "$FIREWALL_SYSTEM" == "ufw" ]]; then
  mapfile -t OPEN_PORTS < <(sudo ufw status numbered 2>/dev/null | awk '/ALLOW/ {print $1 ": " $2}' | sed 's/^/  - /')
elif [[ "$FIREWALL_SYSTEM" == "firewalld" || "$FIREWALL_SYSTEM" == "iptables" ]]; then
  mapfile -t OPEN_PORTS < <(ss -tuln | awk 'NR>1 {print $5}' | cut -d: -f2 | sort -nu | sed 's/^/  - /')
fi

if [[ ${#OPEN_PORTS[@]} -gt 0 ]]; then
  echo "üì° –ó–∞—Å–µ—á–µ–Ω–∏ –æ—Ç–≤–æ—Ä–µ–Ω–∏ –ø–æ—Ä—Ç–æ–≤–µ –≤—ä–≤ –≤–∞—à–∞—Ç–∞ –∑–∞—â–∏—Ç–Ω–∞ —Å—Ç–µ–Ω–∞:"
  for port in "${OPEN_PORTS[@]}"; do
    echo "$port"
  done
  echo ""

  echo "‚ö†Ô∏è  –°—ä–≥–ª–∞—Å–Ω–æ –∏–∑–∏—Å–∫–≤–∞–Ω–∏—è—Ç–∞ –∑–∞ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ç–∞ **NetGalaxy**,"
  echo "–≤—Å–∏—á–∫–∏ –Ω–µ–Ω—É–∂–Ω–∏ –ø–æ—Ä—Ç–æ–≤–µ —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–∞—Ç **–∑–∞—Ç–≤–æ—Ä–µ–Ω–∏** –ø—Ä–∏ –ø—ä—Ä–≤–æ–Ω–∞—á–∞–ª–Ω–∞—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞ —Å—ä—Ä–≤—ä—Ä–∞."
  echo ""
  echo "üëâ –ê–∫–æ —Ç–µ–∑–∏ –ø–æ—Ä—Ç–æ–≤–µ —Å–∞ **–Ω–µ–æ–±—Ö–æ–¥–∏–º–∏** –∑–∞ —Ä–∞–±–æ—Ç–∞—Ç–∞ –Ω–∞ –≤–∞—à–∞—Ç–∞ —Å–∏—Å—Ç–µ–º–∞, –ø–æ—Ç–≤—ä—Ä–¥–µ—Ç–µ —Å 'y'."
  echo "üëâ –ê–∫–æ –∂–µ–ª–∞–µ—Ç–µ —Ç–µ –¥–∞ –±—ä–¥–∞—Ç –∑–∞—Ç–≤–æ—Ä–µ–Ω–∏ (–∏–ª–∏ —â–µ –ø–æ—Å–æ—á–∏—Ç–µ –Ω—É–∂–Ω–∏—Ç–µ –ø–æ-–∫—ä—Å–Ω–æ), –Ω–∞—Ç–∏—Å–Ω–µ—Ç–µ Enter."
  echo "üëâ –ù–∞—Ç–∏—Å–Ω–µ—Ç–µ 'q' –∑–∞ –ø—Ä–µ–∫—Ä–∞—Ç—è–≤–∞–Ω–µ –Ω–∞ —Å–∫—Ä–∏–ø—Ç–∞."

  while true; do
    printf "‚úîÔ∏è –í–∞—à–∏—è—Ç –∏–∑–±–æ—Ä: "
    read ports_keep
    case "$ports_keep" in
      [Yy]*) break ;;
      [Qq]*) echo "‚ùé –°–∫—Ä–∏–ø—Ç—ä—Ç –±–µ—à–µ –ø—Ä–µ–∫—Ä–∞—Ç–µ–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è."; exit 0 ;;
      "")    echo "üîê –û—Ç–≤–∞—Ä—è–Ω–µ—Ç–æ –Ω–∞ –Ω–æ–≤–∏ –ø–æ—Ä—Ç–æ–≤–µ —â–µ –±—ä–¥–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–Ω–æ —Ä—ä—á–Ω–æ –≤ —Å–ª–µ–¥–≤–∞—â–∞—Ç–∞ —Å—Ç—ä–ø–∫–∞."; break ;;
      *)     echo "‚ùå –ú–æ–ª—è, –æ—Ç–≥–æ–≤–æ—Ä–µ—Ç–µ —Å 'y', Enter –∏–ª–∏ 'q'." ;;
    esac
  done
else
  echo "‚úÖ –ù–µ —Å–∞ –∑–∞—Å–µ—á–µ–Ω–∏ –æ—Ç–≤–æ—Ä–µ–Ω–∏ –ø–æ—Ä—Ç–æ–≤–µ –æ—Å–≤–µ–Ω SSH ($SSH_PORT)."
fi
echo ""
echo ""

# --- [5.2] –û–¢–í–ê–†–Ø–ù–ï –ù–ê –î–û–ü–™–õ–ù–ò–¢–ï–õ–ù–ò –ü–û–†–¢–û–í–ï -----------------------------
echo "[5.2] –û–¢–í–ê–†–Ø–ù–ï –ù–ê –î–û–ü–™–õ–ù–ò–¢–ï–õ–ù–ò –ü–û–†–¢–û–í–ï..."
echo "--------------------------------------------------------------------"
echo ""

PORT_LIST=()

# –°–∞–º–æ –∞–∫–æ —Å–∏—Å—Ç–µ–º–∞—Ç–∞ –∏–º–∞ –∑–∞—â–∏—Ç–Ω–∞ —Å—Ç–µ–Ω–∞
if [[ "$FIREWALL_SYSTEM" != "none" ]]; then
  echo "‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï! –û–¢–í–ê–†–Ø–ô–¢–ï –°–ê–ú–û –¢–ï–ó–ò –ü–û–†–¢–û–í–ï, –ó–ê –ö–û–ò–¢–û –°–¢–ï –°–ò–ì–£–†–ù–ò, –ß–ï –°–ê –ù–ï–û–ë–•–û–î–ò–ú–ò!"
  echo "‚ùó –û—Ç–≤–∞—Ä—è–Ω–µ—Ç–æ –Ω–∞ –Ω–µ–Ω—É–∂–Ω–∏ –ø–æ—Ä—Ç–æ–≤–µ —Å—ä–∑–¥–∞–≤–∞ —Ä–∏—Å–∫–æ–≤–µ –∑–∞ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ —Å—ä—Ä–≤—ä—Ä–∞."
  echo ""
  echo "üß© –í—ä–≤–µ–∂–¥–∞–π—Ç–µ –ø–æ –µ–¥–∏–Ω –ø–æ—Ä—Ç –Ω–∞ —Ä–µ–¥ (–º–µ–∂–¥—É 1 –∏ 65535)"
  echo "üëâ –∏–ª–∏ –Ω–∞—Ç–∏—Å–Ω–µ—Ç–µ Enter –±–µ–∑ –≤—ä–≤–µ–∂–¥–∞–Ω–µ –Ω–∞ –ø–æ—Ä—Ç, –∑–∞ –¥–∞ –ø—Ä–æ–¥—ä–ª–∂–∏—Ç–µ."
  echo "üëâ –í—ä–≤–µ–¥–µ—Ç–µ 'q', –∞–∫–æ –∂–µ–ª–∞–µ—Ç–µ –¥–∞ –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç–µ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ—Ç–æ –Ω–∞ —Å–∫—Ä–∏–ø—Ç–∞."
  echo ""

  while true; do
    printf "‚û§ –í—ä–≤–µ–¥–µ—Ç–µ –ø–æ—Ä—Ç: "
    read -r port

    if [[ "$port" == "q" || "$port" == "Q" ]]; then
      echo "‚ùé –°–∫—Ä–∏–ø—Ç—ä—Ç –±–µ—à–µ –ø—Ä–µ–∫—Ä–∞—Ç–µ–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è."
      exit 0
    elif [[ -z "$port" ]]; then
      break
    elif ! [[ "$port" =~ ^[0-9]+$ ]] || (( port < 1 || port > 65535 )); then
      echo "‚ùå –ù–µ–≤–∞–ª–∏–¥–µ–Ω –ø–æ—Ä—Ç. –í—ä–≤–µ–¥–µ—Ç–µ —á–∏—Å–ª–æ –º–µ–∂–¥—É 1 –∏ 65535."
      continue
    fi

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª–∏ –≤–µ—á–µ –µ –≤—ä–≤–µ–¥–µ–Ω
    if [[ " ${PORT_LIST[*]} " =~ " $port " ]]; then
      echo "‚ö†Ô∏è –ü–æ—Ä—Ç $port –≤–µ—á–µ –µ –¥–æ–±–∞–≤–µ–Ω."
    else
      PORT_LIST+=("$port")
      echo "‚úÖ –î–æ–±–∞–≤–µ–Ω –ø–æ—Ä—Ç: $port"
    fi
  done
fi
echo ""
echo ""

# --- [5.3] –î–û–ë–ê–í–Ø–ù–ï –ù–ê –ß–ê–°–¢–ù–ò –ú–†–ï–ñ–ò (TRUSTED_NETS) -------------------------------
echo "[5.3] –î–û–ë–ê–í–Ø–ù–ï –ù–ê –ß–ê–°–¢–ù–ò –ú–†–ï–ñ–ò (TRUSTED_NETS)..."
echo "--------------------------------------------------------------------"
echo ""

TRUSTED_NETS=()

# –ü–∏—Ç–∞–Ω–µ –¥–∞–ª–∏ —â–µ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ —á–∞—Å—Ç–Ω–∞ –º—Ä–µ–∂–∞
while true; do
  printf "üåê –©–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç–µ –ª–∏ –¥–æ—Å—Ç—ä–ø –æ—Ç —á–∞—Å—Ç–Ω–∞ –º—Ä–µ–∂–∞ (–Ω–∞–ø—Ä. VPN, –≤—ä—Ç—Ä–µ—à–Ω–∞ LAN)? (y / n / q –∑–∞ –ø—Ä–µ–∫—Ä–∞—Ç—è–≤–∞–Ω–µ): "
  read -r use_private_net

  if [[ "$use_private_net" == "q" || "$use_private_net" == "Q" ]]; then
    echo "‚ùé –°–∫—Ä–∏–ø—Ç—ä—Ç –±–µ—à–µ –ø—Ä–µ–∫—Ä–∞—Ç–µ–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è."
    exit 0

  elif [[ "$use_private_net" == "y" || "$use_private_net" == "Y" ]]; then
    echo ""
    echo "üß© –í—ä–≤–µ–¥–µ—Ç–µ CIDR –∞–¥—Ä–µ—Å–∏—Ç–µ –Ω–∞ –¥–æ–≤–µ—Ä–µ–Ω–∏—Ç–µ —á–∞—Å—Ç–Ω–∏ –º—Ä–µ–∂–∏ (–Ω–∞–ø—Ä. 10.8.0.0/24):"
    echo "üëâ –ù–∞—Ç–∏—Å–Ω–µ—Ç–µ Enter –±–µ–∑ –≤—ä–≤–µ–∂–¥–∞–Ω–µ –∑–∞ –∫—Ä–∞–π –∏–ª–∏ –≤—ä–≤–µ–¥–µ—Ç–µ 'q' –∑–∞ –ø—Ä–µ–∫—Ä–∞—Ç—è–≤–∞–Ω–µ."
    echo ""

    while true; do
      printf "‚û§ –í—ä–≤–µ–¥–µ—Ç–µ –º—Ä–µ–∂–∞: "
      read -r net

      if [[ "$net" == "q" || "$net" == "Q" ]]; then
        echo "‚ùé –°–∫—Ä–∏–ø—Ç—ä—Ç –±–µ—à–µ –ø—Ä–µ–∫—Ä–∞—Ç–µ–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è."
        exit 0
      elif [[ -z "$net" ]]; then
        break
      elif [[ "$net" =~ ^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+/[0-9]+$ ]]; then
        TRUSTED_NETS+=("$net")
        echo "‚úÖ –î–æ–±–∞–≤–µ–Ω–∞ –º—Ä–µ–∂–∞: $net"
      else
        echo "‚ùå –ù–µ–≤–∞–ª–∏–¥–µ–Ω —Ñ–æ—Ä–º–∞—Ç. –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ CIDR, –Ω–∞–ø—Ä. 192.168.1.0/24"
      fi
    done
    break

  elif [[ "$use_private_net" == "n" || "$use_private_net" == "N" ]]; then
    echo "üîí –ü—Ä–æ–ø—É—Å–∫–∞–Ω–µ –Ω–∞ –¥–æ–±–∞–≤—è–Ω–µ –Ω–∞ –¥–æ–≤–µ—Ä–µ–Ω–∏ —á–∞—Å—Ç–Ω–∏ –º—Ä–µ–∂–∏."
    break

  else
    echo "‚ùå –ù–µ–≤–∞–ª–∏–¥–µ–Ω –æ—Ç–≥–æ–≤–æ—Ä. –ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ 'y', 'n' –∏–ª–∏ 'q'."
  fi
done
echo ""
echo ""

# === [6] –ü–†–ï–ì–õ–ï–î –ù–ê –í–™–í–ï–î–ï–ù–ê–¢–ê –ò–ù–§–û–†–ú–ê–¶–ò–Ø =====================================
echo "[6] –ü–†–ï–ì–õ–ï–î –ù–ê –í–™–í–ï–î–ï–ù–ê–¢–ê –ò–ù–§–û–†–ú–ê–¶–ò–Ø..."
echo "-------------------------------------------------------------------------"
echo ""

# –¶–≤–µ—Ç–æ–≤–µ, –∞–∫–æ —Ç–µ—Ä–º–∏–Ω–∞–ª—ä—Ç –≥–∏ –ø–æ–¥–¥—ä—Ä–∂–∞
if [[ -t 1 && "$TERM" != "dumb" ]]; then
  COLOR_YELLOW="\e[93m"      # –Ø—Ä–∫–æ –∂—ä–ª—Ç
  COLOR_GREEN="\e[32;1m"     # –£–¥–µ–±–µ–ª–µ–Ω –∑–µ–ª–µ–Ω
  COLOR_RESET="\e[0m"
else
  COLOR_YELLOW=""
  COLOR_GREEN=""
  COLOR_RESET=""
fi

# –û–±–æ–±—â–µ–Ω–∏–µ
echo -e "‚úÖ ${COLOR_YELLOW}–°—ä—Ä–≤—ä—Ä—ä—Ç —â–µ –±—ä–¥–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–Ω —Å—ä—Å —Å–ª–µ–¥–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏:${COLOR_RESET}"
echo ""
echo -e " - ${COLOR_YELLOW}IP –∞–¥—Ä–µ—Å:${COLOR_RESET}               ${COLOR_GREEN}${SERVER_IP}${COLOR_RESET}"
echo -e " - ${COLOR_YELLOW}–î–æ–º–µ–π–Ω (FQDN):${COLOR_RESET}          ${COLOR_GREEN}${FQDN}${COLOR_RESET}"
echo -e " - ${COLOR_YELLOW}SSH –ø–æ—Ä—Ç:${COLOR_RESET}               ${COLOR_GREEN}${SSH_PORT}${COLOR_RESET}"
echo -e " - ${COLOR_YELLOW}–ó–∞—â–∏—Ç–Ω–∞ —Å—Ç–µ–Ω–∞:${COLOR_RESET}          ${COLOR_GREEN}${FIREWALL_SYSTEM}${COLOR_RESET}"
echo ""
echo -e " - ${COLOR_YELLOW}–°—ä—Ä–≤—ä—Ä–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:${COLOR_RESET} ${COLOR_GREEN}${ADMIN_USER}${COLOR_RESET}"
echo -e " - ${COLOR_YELLOW}Root –¥–æ—Å—Ç—ä–ø –ø–æ SSH:${COLOR_RESET}     ${COLOR_GREEN}–©–µ –±—ä–¥–µ –∑–∞–±—Ä–∞–Ω–µ–Ω${COLOR_RESET}"
if [[ ${#PORT_LIST[@]} -gt 0 ]]; then
  echo -e " - ${COLOR_YELLOW}–î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏ –ø–æ—Ä—Ç–æ–≤–µ:${COLOR_RESET}   ${COLOR_GREEN}${PORT_LIST[*]}${COLOR_RESET}"
fi

if [[ ${#TRUSTED_NETS[@]} -gt 0 ]]; then
  echo -e " - ${COLOR_YELLOW}–ß–∞—Å—Ç–Ω–∏ –º—Ä–µ–∂–∏ —Å –¥–æ—Å—Ç—ä–ø:${COLOR_RESET}  ${COLOR_GREEN}${TRUSTED_NETS[*]}${COLOR_RESET}"
else
  echo -e " - ${COLOR_YELLOW}–ß–∞—Å—Ç–Ω–∏ –º—Ä–µ–∂–∏ —Å –¥–æ—Å—Ç—ä–ø:${COLOR_RESET}  ${COLOR_GREEN}–Ω—è–º–∞ –¥–æ–±–∞–≤–µ–Ω–∏${COLOR_RESET}"
fi

echo ""
echo "üßê –ú–æ–ª—è, –ø—Ä–µ–≥–ª–µ–¥–∞–π—Ç–µ –≤–Ω–∏–º–∞—Ç–µ–ª–Ω–æ –ø—Ä–∞–≤–∏–ª–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –≤—ä–≤–µ–¥–µ–Ω–∞—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ-–≥–æ—Ä–µ."
echo "–ê–∫–æ –∏–º–∞—Ç–µ –∑–∞–±–µ–ª–µ–∂–∫–∏, –ø—Ä–µ–∫—Ä–∞—Ç–µ—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞, –∫–æ—Ä–∏–≥–∏—Ä–∞–π—Ç–µ –∏ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ —Ç–æ–∑–∏ —Å–∫—Ä–∏–ø—Ç."
echo ""

while true; do
  printf "‚úîÔ∏è –í—ä–≤–µ–¥–µ—Ç–µ '${COLOR_GREEN}y${COLOR_RESET}' –∑–∞ –ø—Ä–æ–¥—ä–ª–∂–µ–Ω–∏–µ –∏–ª–∏ '${COLOR_GREEN}q${COLOR_RESET}' –∑–∞ –ø—Ä–µ–∫—Ä–∞—Ç—è–≤–∞–Ω–µ: "
  read CONFIRMATION
  if [[ "$CONFIRMATION" == "q" || "$CONFIRMATION" == "Q" ]]; then
    echo "‚ùé –°–∫—Ä–∏–ø—Ç—ä—Ç –±–µ—à–µ –ø—Ä–µ–∫—Ä–∞—Ç–µ–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è."
    exit 0
  elif [[ "$CONFIRMATION" == "y" || "$CONFIRMATION" == "Y" ]]; then
    echo "üöÄ –°—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è..."
    sleep 1
    clear
    break
  else
    echo "‚ùå –ú–æ–ª—è, –æ—Ç–≥–æ–≤–æ—Ä–µ—Ç–µ —Å 'y' –∑–∞ –ø—Ä–æ–¥—ä–ª–∂–µ–Ω–∏–µ –∏–ª–∏ 'q' –∑–∞ –ø—Ä–µ–∫—Ä–∞—Ç—è–≤–∞–Ω–µ."
  fi
done
echo ""
echo ""


# ====== –°–¢–™–ü–ö–ê 2: –ö–û–ù–§–ò–ì–£–†–ò–†–ê–ù–ï –ù–ê –°–ò–°–¢–ï–ú–ê–¢–ê ====================================
echo "== –°–¢–™–ü–ö–ê 2: –ö–û–ù–§–ò–ì–£–†–ò–†–ê–ù–ï –ù–ê –°–ò–°–¢–ï–ú–ê–¢–ê =="
echo ""
echo ""
# ================================================================================
echo ""
echo ""

echo "[7] –û–ë–ù–û–í–Ø–í–ê–ù–ï –ù–ê –°–ò–°–¢–ï–ú–ê–¢–ê..."
echo "-------------------------------------------------------------------------"

# –ò–∑—á–∞–∫–≤–∞–Ω–µ, –∞–∫–æ —Å–∏—Å—Ç–µ–º–∞—Ç–∞ –µ –∑–∞–∫–ª—é—á–µ–Ω–∞ –æ—Ç –¥—Ä—É–≥ apt –ø—Ä–æ—Ü–µ—Å
MAX_WAIT=60
COUNTER=0
echo "‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –∑–∞–µ—Ç–æ—Å—Ç –Ω–∞ –ø–∞–∫–µ—Ç–Ω–∞—Ç–∞ —Å–∏—Å—Ç–µ–º–∞..."
while fuser /var/lib/dpkg/lock-frontend >/dev/null 2>&1; do
  sleep 1
  ((COUNTER++))
  if ((COUNTER >= MAX_WAIT)); then
    echo "‚ùå –ü–∞–∫–µ—Ç–Ω–∞—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –µ –∑–∞–∫–ª—é—á–µ–Ω–∞ –æ—Ç –¥—Ä—É–≥ –ø—Ä–æ—Ü–µ—Å –ø–æ–≤–µ—á–µ –æ—Ç ${MAX_WAIT} —Å–µ–∫—É–Ω–¥–∏."
    echo "   –ú–æ–ª—è, –æ–ø–∏—Ç–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ –ø–æ-–∫—ä—Å–Ω–æ."
    RESULT_SYSTEM_UPDATE="‚ùå"
    exit 1
  fi
done

# –ò–∑–ø—ä–ª–Ω–µ–Ω–∏–µ –Ω–∞ –æ–±–Ω–æ–≤—è–≤–∞–Ω–µ—Ç–æ
if sudo apt-get update && sudo apt-get upgrade -y && sudo apt-get autoremove -y; then
  echo "‚úÖ –°–∏—Å—Ç–µ–º–∞—Ç–∞ –µ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–µ–Ω–∞."
  RESULT_SYSTEM_UPDATE="‚úÖ"
else
  echo "‚ùå –í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤—è–≤–∞–Ω–µ –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ç–∞. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –≥–æ—Ä–Ω–∏—Ç–µ —Å—ä–æ–±—â–µ–Ω–∏—è."
  RESULT_SYSTEM_UPDATE="‚ùå"
  exit 1
fi
echo ""
echo ""

echo "[8] –ò–ù–°–¢–ê–õ–ò–†–ê–ù–ï –ù–ê –û–°–ù–û–í–ù–ò–¢–ï –ò–ù–°–¢–†–£–ú–ï–ù–¢–ò..."
echo "-------------------------------------------------------------------------"

if sudo apt-get install -y \
    nano unzip git curl wget net-tools htop \
    python3 python3-pip python3-venv build-essential; then
  echo "‚úÖ –í—Å–∏—á–∫–∏ –æ—Å–Ω–æ–≤–Ω–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å–∞ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω–∏."
  RESULT_BASE_TOOLS="‚úÖ"
else
  echo "‚ùå –í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –∏–Ω—Å—Ç–∞–ª–∞—Ü–∏—è—Ç–∞. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ:"
  echo "1. –î–∞–ª–∏ apt-get cache –µ –æ–±–Ω–æ–≤–µ–Ω (–≤ –ø—Ä–µ–¥—Ö–æ–¥–Ω–∞—Ç–∞ —Å—Ç—ä–ø–∫–∞)"
  echo "2. –î–∞–ª–∏ –∏–º–∞ –¥–æ—Å—Ç–∞—Ç—ä—á–Ω–æ –¥–∏—Å–∫–æ–≤–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ"
  RESULT_BASE_TOOLS="‚ùå"
  exit 1
fi
echo ""
echo ""

echo "[9] –°–™–ó–î–ê–í–ê–ù–ï –ù–ê –ù–û–í –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–°–ö–ò –ü–†–û–§–ò–õ..."
echo "-------------------------------------------------------------------------"
RESULT_ADMIN_USER="‚ùî"

# –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è
if id "$ADMIN_USER" &>/dev/null; then
  echo "‚ÑπÔ∏è –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç '$ADMIN_USER' –≤–µ—á–µ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞ ‚Äì –ø—Ä–æ–ø—É—Å–∫–∞–Ω–µ –Ω–∞ —Å—ä–∑–¥–∞–≤–∞–Ω–µ—Ç–æ."
  RESULT_ADMIN_USER="‚ö†Ô∏è"
else
  if sudo adduser --disabled-password --gecos "" "$ADMIN_USER" && \
     echo "$ADMIN_USER:$PASSWORD_1" | sudo chpasswd && \
     sudo usermod -aG sudo "$ADMIN_USER"; then
    echo "‚úÖ –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç '$ADMIN_USER' –µ —Å—ä–∑–¥–∞–¥–µ–Ω –∏ –¥–æ–±–∞–≤–µ–Ω –∫—ä–º sudo –≥—Ä—É–ø–∞—Ç–∞."
    RESULT_ADMIN_USER="‚úÖ"
  else
    echo "‚ùå –í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ —Å—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è '$ADMIN_USER'."
    RESULT_ADMIN_USER="‚ùå"
    exit 1
  fi
fi

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ SSH –¥–æ—Å—Ç—ä–ø (–∫–æ–ø–∏—Ä–∞–Ω–µ –Ω–∞ –∫–ª—é—á–æ–≤–µ—Ç–µ –æ—Ç root)
if [[ -f /root/.ssh/authorized_keys ]]; then
  if sudo mkdir -p /home/"$ADMIN_USER"/.ssh && \
     sudo cp /root/.ssh/authorized_keys /home/"$ADMIN_USER"/.ssh/ && \
     sudo chown -R "$ADMIN_USER":"$ADMIN_USER" /home/"$ADMIN_USER"/.ssh && \
     sudo chmod 700 /home/"$ADMIN_USER"/.ssh && \
     sudo chmod 600 /home/"$ADMIN_USER"/.ssh/authorized_keys; then
    echo "‚úÖ –ö–æ–ø–∏—Ä–∞–Ω–∏ —Å–∞ SSH –∫–ª—é—á–æ–≤–µ—Ç–µ –æ—Ç root."
  else
    echo "‚ö†Ô∏è –ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–∞–Ω–µ –Ω–∞ SSH –∫–ª—é—á–æ–≤–µ—Ç–µ."
    RESULT_ADMIN_USER="‚ö†Ô∏è"
  fi
else
  echo "‚ö†Ô∏è –ù–µ —Å–∞ –æ—Ç–∫—Ä–∏—Ç–∏ SSH –∫–ª—é—á–æ–≤–µ –∑–∞ –∫–æ–ø–∏—Ä–∞–Ω–µ –æ—Ç root."
fi
echo ""
echo ""

echo "[10] –ù–ê–°–¢–†–û–ô–ö–ê –ù–ê –õ–û–ö–ê–õ–ò–ó–ê–¶–ò–ò..."
echo "-------------------------------------------------------------------------"
RESULT_LOCALES="‚ùî"

# –ò–Ω—Å—Ç–∞–ª–∞—Ü–∏—è –Ω–∞ –µ–∑–∏–∫–æ–≤–∏ –ø–∞–∫–µ—Ç–∏
if ! sudo apt-get install -y language-pack-bg language-pack-ru; then
  echo "‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –ù–µ—É—Å–ø–µ—à–Ω–∞ –∏–Ω—Å—Ç–∞–ª–∞—Ü–∏—è –Ω–∞ –µ–∑–∏–∫–æ–≤–∏ –ø–∞–∫–µ—Ç–∏. –ü—Ä–æ–¥—ä–ª–∂–µ–Ω–∏–µ –±–µ–∑ —Ç—è—Ö."
  RESULT_LOCALES="‚ö†Ô∏è"
fi

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–Ω–µ –Ω–∞ /etc/locale.gen
sudo sed -i '/^# *bg_BG.UTF-8 UTF-8/s/^# *//g' /etc/locale.gen
sudo sed -i '/^# *ru_RU.UTF-8 UTF-8/s/^# *//g' /etc/locale.gen
sudo sed -i '/^# *en_US.UTF-8 UTF-8/s/^# *//g' /etc/locale.gen

# –î–æ–±–∞–≤—è–Ω–µ –Ω–∞ –ª–æ–∫–∞–ª–∏ –∞–∫–æ –ª–∏–ø—Å–≤–∞—Ç
grep -qxF 'bg_BG.UTF-8 UTF-8' /etc/locale.gen || echo 'bg_BG.UTF-8 UTF-8' | sudo tee -a /etc/locale.gen >/dev/null
grep -qxF 'ru_RU.UTF-8 UTF-8' /etc/locale.gen || echo 'ru_RU.UTF-8 UTF-8' | sudo tee -a /etc/locale.gen >/dev/null
grep -qxF 'en_US.UTF-8 UTF-8' /etc/locale.gen || echo 'en_US.UTF-8 UTF-8' | sudo tee -a /etc/locale.gen >/dev/null

# –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ –ª–æ–∫–∞–ª–∏
if sudo locale-gen && sudo update-locale; then
  echo "‚úÖ –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏—Ç–µ —Å–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏."
  [[ "$RESULT_LOCALES" == "‚ùî" ]] && RESULT_LOCALES="‚úÖ"
else
  echo "‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ –ª–æ–∫–∞–ª–∏. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ —Ä—ä—á–Ω–æ."
  RESULT_LOCALES="‚ùå"
fi
echo ""
echo ""

echo "[11] –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ù–ê –í–†–ï–ú–ï–í–ê –ó–û–ù–ê UTC..."
echo "-------------------------------------------------------------------------"
RESULT_TIMEZONE="‚ùî"

# –ü—Ä–æ–º—è–Ω–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω–∞—Ç–∞ —á–∞—Å–æ–≤–∞ –∑–æ–Ω–∞ –Ω–∞ UTC
if sudo timedatectl set-timezone UTC; then
  echo "‚úÖ –í—Ä–µ–º–µ–≤–∞—Ç–∞ –∑–æ–Ω–∞ –µ –∑–∞–¥–∞–¥–µ–Ω–∞ –Ω–∞ UTC."
  RESULT_TIMEZONE="‚úÖ"
else
  echo "‚ùå –ù–µ—É—Å–ø–µ—à–Ω–∞ —Å–º—è–Ω–∞ –Ω–∞ –≤—Ä–µ–º–µ–≤–∞—Ç–∞ –∑–æ–Ω–∞. –ú–æ–ª—è, –ø—Ä–æ–≤–µ—Ä–µ—Ç–µ —Ä—ä—á–Ω–æ."
  RESULT_TIMEZONE="‚ùå"
  exit 1
fi
echo ""
echo ""

echo "[12] –ù–ê–°–¢–†–û–ô–ö–ê –ù–ê –í–†–ï–ú–ï–í–ê–¢–ê –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø..."
echo "-------------------------------------------------------------------------"
RESULT_NTP_SYNC="‚ùî"

# –°–ø–∏—Ä–∞–Ω–µ –Ω–∞ –¥—Ä—É–≥–∏ NTP —É—Å–ª—É–≥–∏
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –∞–∫—Ç–∏–≤–Ω–∏ NTP —É—Å–ª—É–≥–∏..."
sudo systemctl stop ntpd 2>/dev/null && sudo systemctl disable ntpd 2>/dev/null
sudo systemctl stop systemd-timesyncd 2>/dev/null && sudo systemctl disable systemd-timesyncd 2>/dev/null

# –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω–µ –Ω–∞ chrony
echo "üì¶ –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω–µ –Ω–∞ chrony..."
if ! sudo apt-get install -y chrony; then
  echo "‚ùå –ù–µ—É—Å–ø–µ—à–Ω–∞ –∏–Ω—Å—Ç–∞–ª–∞—Ü–∏—è –Ω–∞ chrony."
  RESULT_NTP_SYNC="‚ùå"
  exit 1
fi

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞ chrony —Å —É–Ω–∏–≤–µ—Ä—Å–∞–ª–Ω–∏ —Å—ä—Ä–≤—ä—Ä–∏
NTP_SERVERS=(0.pool.ntp.org 1.pool.ntp.org 2.pool.ntp.org 3.pool.ntp.org)
echo "‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–Ω–µ –Ω–∞ chrony —Å –ø—É–±–ª–∏—á–Ω–∏ —Å—ä—Ä–≤—ä—Ä–∏: ${NTP_SERVERS[*]}"
echo -e "server ${NTP_SERVERS[0]} iburst
server ${NTP_SERVERS[1]} iburst
server ${NTP_SERVERS[2]} iburst
server ${NTP_SERVERS[3]} iburst

rtcsync
makestep 1.0 3
driftfile /var/lib/chrony/drift
logdir /var/log/chrony" | sudo tee /etc/chrony/chrony.conf > /dev/null

# –†–µ—Å—Ç–∞—Ä—Ç –∏ –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω–µ
sudo systemctl restart chrony
sudo systemctl enable chrony

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–∞—Ç—É—Å–∞
echo "üîé –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è—Ç–∞..."
timedatectl | grep 'Time zone'
echo "NTP —Å—Ç–∞—Ç—É—Å:"
chronyc tracking | grep -E 'Stratum|System time'
chronyc sources | grep '^\^\*'

echo "‚úÖ –í—Ä–µ–º–µ–≤–∞—Ç–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–Ω–∞."
RESULT_NTP_SYNC="‚úÖ"
echo ""
echo ""

echo "[13] –ù–ê–°–¢–†–û–ô–ö–ê –ù–ê HOSTNAME..."
echo "-------------------------------------------------------------------------"
RESULT_HOSTNAME="‚ùî"

# –ò–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –∫—Ä–∞—Ç–∫–æ—Ç–æ –∏–º–µ –Ω–∞ —Ö–æ—Å—Ç–∞ –æ—Ç FQDN
HOSTNAME_SHORT="${FQDN%%.*}"

# –ó–∞–¥–∞–≤–∞–Ω–µ –Ω–∞ hostname
if sudo hostnamectl set-hostname "$FQDN"; then
  echo "‚úÖ Hostname –∑–∞–¥–∞–¥–µ–Ω –Ω–∞: $FQDN"
  RESULT_HOSTNAME="‚úÖ"
else
  echo "‚ùå –ù–µ—É—Å–ø–µ—à–Ω–∞ —Å–º—è–Ω–∞ –Ω–∞ hostname."
  RESULT_HOSTNAME="‚ùå"
  exit 1
fi

# –ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ /etc/hosts
sudo tee /etc/hosts > /dev/null <<EOF
127.0.0.1   localhost
127.0.1.1   $FQDN $HOSTNAME_SHORT
::1         localhost ip6-localhost ip6-loopback
ff02::1     ip6-allnodes
ff02::2     ip6-allrouters
EOF

echo "‚úÖ /etc/hosts –µ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–Ω."
echo ""
echo ""

# === –°–¢–™–ü–ö–ê 3: –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ù–ê UFW –ò –†–ï–°–¢–ê–†–¢ –ù–ê –°–™–†–í–™–†–ê ==========================
echo "=== –°–¢–™–ü–ö–ê 3: –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ù–ê UFW –ò –†–ï–°–¢–ê–†–¢ –ù–ê –°–™–†–í–™–†–ê"
echo ""

echo "[14] –ù–ê–°–¢–†–û–ô–ö–ê –ù–ê SSH –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø..."
echo "-------------------------------------------------------------------------"
RESULT_SSH_CONFIG="‚ùî"

# –†–µ–∑–µ—Ä–≤–Ω–æ –∫–æ–ø–∏–µ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏—è —Ñ–∞–π–ª
if [[ -f /etc/ssh/sshd_config ]]; then
  sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak
fi

# –ü—Ä–µ–º–∞—Ö–≤–∞–Ω–µ –Ω–∞ —Å—Ç–∞—Ä–∏ –∑–∞–ø–∏—Å–∏ –∏ –¥–æ–±–∞–≤—è–Ω–µ –Ω–∞ –Ω–æ–≤–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
sudo sed -i "/^#*Port /d" /etc/ssh/sshd_config
sudo sed -i "/^#*PermitRootLogin /d" /etc/ssh/sshd_config
sudo sed -i "/^#*PasswordAuthentication /d" /etc/ssh/sshd_config

echo "" | sudo tee -a /etc/ssh/sshd_config >/dev/null
echo "Port $SSH_PORT" | sudo tee -a /etc/ssh/sshd_config >/dev/null
echo "PermitRootLogin no" | sudo tee -a /etc/ssh/sshd_config >/dev/null
echo "PasswordAuthentication yes" | sudo tee -a /etc/ssh/sshd_config >/dev/null

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ —Å–∏–Ω—Ç–∞–∫—Ç–∏—á–Ω–∏ –≥—Ä–µ—à–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ)
if ! sudo sshd -t; then
  echo "‚ùå –ì—Ä–µ—à–∫–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–∏—è —Ñ–∞–π–ª –Ω–∞ SSH. –í—ä–∑—Å—Ç–∞–Ω–æ–≤—è–≤–∞–Ω–µ –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ—Ç–æ –∫–æ–ø–∏–µ..."
  sudo cp /etc/ssh/sshd_config.bak /etc/ssh/sshd_config
  RESULT_SSH_CONFIG="‚ùå"
  exit 1
fi

# –†–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ SSH
echo "üîÑ –†–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ SSH —É—Å–ª—É–≥–∞—Ç–∞..."
if sudo systemctl restart ssh; then
  echo "‚úÖ SSH –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞ –µ –æ–±–Ω–æ–≤–µ–Ω–∞ –∏ —É—Å–ª—É–≥–∞—Ç–∞ –µ —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ."
  RESULT_SSH_CONFIG="‚úÖ"
else
  echo "‚ùå –ù–µ—É—Å–ø–µ—à–Ω–æ —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ SSH. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞."
  RESULT_SSH_CONFIG="‚ùå"
  exit 1
fi

echo ""
echo ""

# --- [15] –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ù–ê UFW –ò –†–ï–°–¢–ê–†–¢ –ù–ê –°–™–†–í–™–†–ê -----------------------------
echo "[15] –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ù–ê UFW –ò –†–ï–°–¢–ê–†–¢ –ù–ê –°–™–†–í–™–†–ê..."
echo "-------------------------------------------------------------------------"
RESULT_UFW_CONFIG="‚ùî"

# –î–æ–±–∞–≤—è–Ω–µ –Ω–∞ –¥–æ–≤–µ—Ä–µ–Ω–∏ –º—Ä–µ–∂–∏ (–∞–∫–æ –∏–º–∞ –≤—ä–≤–µ–¥–µ–Ω–∏)
if [[ ${#TRUSTED_NETS[@]} -gt 0 ]]; then
  echo ""
  echo "üåê –î–æ–±–∞–≤—è–Ω–µ –Ω–∞ –¥–æ–≤–µ—Ä–µ–Ω–∏ –º—Ä–µ–∂–∏ –≤ –∑–∞—â–∏—Ç–Ω–∞—Ç–∞ —Å—Ç–µ–Ω–∞:"
  for net in "${TRUSTED_NETS[@]}"; do
    echo "üîê –†–∞–∑—Ä–µ—à–∞–≤–∞–Ω–µ –Ω–∞ –¥–æ—Å—Ç—ä–ø –æ—Ç $net –∫—ä–º –≤—Å–∏—á–∫–∏ –ø–æ—Ä—Ç–æ–≤–µ..."
    sudo ufw allow from "$net"
  done
fi

# –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω–µ –Ω–∞ UFW, –∞–∫–æ –Ω–µ –µ –Ω–∞–ª–∏—á–µ–Ω
if ! command -v ufw >/dev/null 2>&1; then
  echo "üì¶ –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω–µ –Ω–∞ UFW..."
  if ! sudo apt-get install -y ufw; then
    echo "‚ùå –ù–µ—É—Å–ø–µ—à–Ω–∞ –∏–Ω—Å—Ç–∞–ª–∞—Ü–∏—è –Ω–∞ UFW."
    RESULT_UFW_CONFIG="‚ùå"
    exit 1
  fi
fi

# –†–∞–∑—Ä–µ—à–∞–≤–∞–Ω–µ –Ω–∞ –∑–∞–ø–∏—Å–∞–Ω–∏—Ç–µ –ø–æ—Ä—Ç–æ–≤–µ
for port in "${PORT_LIST[@]}"; do
  echo "üîì –û—Ç–≤–∞—Ä—è–Ω–µ –Ω–∞ –ø–æ—Ä—Ç $port..."
  sudo ufw allow "$port"
done

# –†–∞–∑—Ä–µ—à–∞–≤–∞–Ω–µ –Ω–∞ SSH –ø–æ—Ä—Ç–∞, –∞–∫–æ –Ω–µ –µ –≤–µ—á–µ –¥–æ–±–∞–≤–µ–Ω
if ! sudo ufw status | grep -q "$SSH_PORT"; then
  sudo ufw allow "$SSH_PORT"
fi

# –ê–∫—Ç–∏–≤–∏—Ä–∞–Ω–µ –Ω–∞ UFW
if sudo ufw --force enable; then
  echo "‚úÖ UFW –µ –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–Ω."
  RESULT_UFW_CONFIG="‚úÖ"
else
  echo "‚ùå –ù–µ—É—Å–ø–µ—à–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω–µ –Ω–∞ UFW."
  RESULT_UFW_CONFIG="‚ùå"
  exit 1
fi

# –†–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ SSH —Å–ª–µ–¥ –ø—Ä–æ–º—è–Ω–∞ –Ω–∞ –ø–æ—Ä—Ç–∞ (–∞–∫–æ –µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ)
echo "üîÑ –†–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ SSH —É—Å–ª—É–≥–∞—Ç–∞..."
if sudo systemctl restart ssh; then
  echo "‚úÖ SSH —É—Å–ª—É–≥–∞—Ç–∞ –µ —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ."
else
  echo "‚ùå –ù–µ—É—Å–ø–µ—à–Ω–æ —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ SSH. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞."
  RESULT_UFW_CONFIG="‚ùå"
  exit 1
fi

# –û—Ç—Ä–∞–∑—è–≤–∞–Ω–µ –Ω–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞ –∑–∞ –¥–æ–≤–µ—Ä–µ–Ω–∏ –º—Ä–µ–∂–∏
if [[ ${#TRUSTED_NETS[@]} -gt 0 ]]; then
  RESULT_TRUSTED_NETS="‚úÖ"
else
  RESULT_TRUSTED_NETS="üîí –Ω—è–º–∞"
fi
echo ""
echo ""

echo "[16] –§–ò–ù–ê–õ–ù–ê –ü–†–û–í–ï–†–ö–ê –ò –û–ë–û–ë–©–ï–ù–ò–ï –ù–ê –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø–¢–ê"
echo "-------------------------------------------------------------------------"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ sshd_config
SSHD_CONFIG_FILE="/etc/ssh/sshd_config"
RESULT_SSH_PORT="‚ùî"
RESULT_SSH_PASSWORD_AUTH="‚ùî"
RESULT_SSH_ROOT_LOGIN="‚ùî"

EXPECTED_PORT="$SSH_PORT"
EXPECTED_PERMIT_ROOT="no"
EXPECTED_PASS_AUTH="yes"

ACTUAL_PORT=$(grep -Ei '^Port ' "$SSHD_CONFIG_FILE" | awk '{print $2}')
ACTUAL_PERMIT_ROOT=$(grep -Ei '^PermitRootLogin ' "$SSHD_CONFIG_FILE" | awk '{print $2}')
ACTUAL_PASS_AUTH=$(grep -Ei '^PasswordAuthentication ' "$SSHD_CONFIG_FILE" | awk '{print $2}')

# –°—Ä–∞–≤–Ω–µ–Ω–∏—è
[[ "$ACTUAL_PORT" == "$EXPECTED_PORT" ]] && RESULT_SSH_PORT="‚úÖ" || RESULT_SSH_PORT="‚ùå"
[[ "$ACTUAL_PASS_AUTH" == "$EXPECTED_PASS_AUTH" ]] && RESULT_SSH_PASSWORD_AUTH="‚úÖ" || RESULT_SSH_PASSWORD_AUTH="‚ùå"
[[ "$ACTUAL_PERMIT_ROOT" == "$EXPECTED_PERMIT_ROOT" ]] && RESULT_SSH_ROOT_LOGIN="‚úÖ" || RESULT_SSH_ROOT_LOGIN="‚ùå"

# –û–±–æ–±—â–µ–Ω–∏–µ
printf "üìå –°–∏—Å—Ç–µ–º–Ω–æ –æ–±–Ω–æ–≤—è–≤–∞–Ω–µ:             %s\n" "${RESULT_SYSTEM_UPDATE:-‚ùî}"
printf "üìå –û—Å–Ω–æ–≤–Ω–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏:             %s\n" "${RESULT_BASE_TOOLS:-‚ùî}"
printf "üìå –ê–¥–º–∏–Ω. –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª:               %s\n" "${RESULT_ADMIN_USER:-‚ùî}"
printf "üìå –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏:                     %s\n" "${RESULT_LOCALES:-‚ùî}"
printf "üìå –ß–∞—Å–æ–≤–∞ –∑–æ–Ω–∞:                     %s\n" "${RESULT_TIMEZONE:-‚ùî}"
printf "üìå –í—Ä–µ–º–µ–≤–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:           %s\n" "${RESULT_NTP_SYNC:-‚ùî}"
printf "üìå Hostname:                        %s\n" "${RESULT_HOSTNAME:-‚ùî}"
printf "üìå UFW –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:                %s\n" "${RESULT_UFW_CONFIG:-‚ùî}"
printf "üìå –ß–∞—Å—Ç–Ω–∏ –º—Ä–µ–∂–∏ (Trusted):          %s\n" "${RESULT_TRUSTED_NETS:-‚ùî}"
printf "üìå SSH –ø–æ—Ä—Ç:                         %s\n" "${RESULT_SSH_PORT:-‚ùî}"
printf "üìå –í–ª–∏–∑–∞–Ω–µ —Å –ø–∞—Ä–æ–ª–∞:                %s\n" "${RESULT_SSH_PASSWORD_AUTH:-‚ùî}"
printf "üìå –í–ª–∏–∑–∞–Ω–µ –∫–∞—Ç–æ Root:               %s\n" "${RESULT_SSH_ROOT_LOGIN:-‚ùî}"

echo ""
echo "‚ÑπÔ∏è  –õ–µ–≥–µ–Ω–¥–∞: ‚úÖ —É—Å–ø–µ—à–Ω–æ | ‚ùå –Ω–µ—É—Å–ø–µ—à–Ω–æ | ‚ö†Ô∏è —á–∞—Å—Ç–∏—á–Ω–æ | ‚ùî –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
echo ""

# –ü–æ—Ç–≤—ä—Ä–∂–¥–µ–Ω–∏–µ –∑–∞ —Ä–µ—Å—Ç–∞—Ä—Ç
echo ""
echo -e "\e[33m–í–ù–ò–ú–ê–ù–ò–ï: –°–ª–µ–¥–≤–∞—â–æ—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ —â–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞ —Å—ä—Ä–≤—ä—Ä–∞!"
echo "‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
echo -e "\e[0m"

while true; do
  printf "üëâ –í—ä–≤–µ–¥–µ—Ç–µ (R) –∑–∞ –†–ï–°–¢–ê–†–¢ –∏–ª–∏ (Q) –∑–∞ –∏–∑—Ö–æ–¥ –±–µ–∑ —Ä–µ—Å—Ç–∞—Ä—Ç: "
  read choice
  case "$choice" in
    [Rr]*)
      SCRIPT_PATH="$(realpath "$0")"
      if [[ -f "$SCRIPT_PATH" && "$SCRIPT_PATH" != "/usr/bin/bash" ]]; then
        echo "üßπ –ü—Ä–µ–º–∞—Ö–≤–∞–Ω–µ –Ω–∞ –∏–Ω—Å—Ç–∞–ª–∞—Ü–∏–æ–Ω–Ω–∏—è —Å–∫—Ä–∏–ø—Ç: $SCRIPT_PATH"
        rm -f "$SCRIPT_PATH"
      else
        echo "‚ÑπÔ∏è –°–∫—Ä–∏–ø—Ç—ä—Ç –Ω–µ –µ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω –æ—Ç —Ñ–∞–π–ª –∏–ª–∏ –Ω–µ –º–æ–∂–µ –¥–∞ –±—ä–¥–µ –ø—Ä–µ–º–∞—Ö–Ω–∞—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ."
      fi

      echo -e "\e[32m[‚úì] –ò–Ω–∏—Ü–∏–∏—Ä–∞–Ω–µ –Ω–∞ —Ä–µ—Å—Ç–∞—Ä—Ç...\e[0m"
      sudo reboot
      exit 0
      ;;
    [Qq]*)
      echo -e "\e[31m[X] –°–∫—Ä–∏–ø—Ç—ä—Ç –ø—Ä–∏–∫–ª—é—á–∏ –±–µ–∑ —Ä–µ—Å—Ç–∞—Ä—Ç. –ú–æ–∂–µ—Ç–µ –¥–∞ —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞—Ç–µ —Ä—ä—á–Ω–æ –ø–æ-–∫—ä—Å–Ω–æ.\e[0m"
      break
      ;;
    *)
      echo -e "\e[31m[!] –ù–µ–≤–∞–ª–∏–¥–µ–Ω –∏–∑–±–æ—Ä. –ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ R –∏–ª–∏ Q.\e[0m"
      ;;
  esac
done

echo -e "\n‚úÖ –°–∫—Ä–∏–ø—Ç—ä—Ç –¥–æ—Å—Ç–∏–≥–Ω–∞ –∫—Ä–∞—è –Ω–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ—Ç–æ.\n"

# --------- –ö—Ä–∞–π –Ω–∞ —Å–∫—Ä–∏–ø—Ç–∞ ---------
