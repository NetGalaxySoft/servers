# vps-dns-secure.sh ‚Äì –°–∫—Ä–∏–ø—Ç –∑–∞ –ø–æ–¥—Å–∏–ª–≤–∞–Ω–µ –Ω–∞ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ DNS —Å—ä—Ä–≤—ä—Ä–∏ (Bind9)

## üìå –í—ä–≤–µ–¥–µ–Ω–∏–µ
`vps-dns-secure.sh` –µ —Å–∫—Ä–∏–ø—Ç –∑–∞ –ø—Ä–∏–ª–∞–≥–∞–Ω–µ –Ω–∞ **–º–µ—Ä–∫–∏ –∑–∞ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç –≤—ä—Ä—Ö—É –≤–µ—á–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–Ω DNS —Å—ä—Ä–≤—ä—Ä (Bind9)**.  
–°—ä–∑–¥–∞–¥–µ–Ω –µ –¥–∞ —Ä–∞–±–æ—Ç–∏ —Å–ª–µ–¥ —É—Å–ø–µ—à–Ω–æ—Ç–æ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ –Ω–∞ `vps-dns-qsetup.sh` –∏ –∏–º–∞ –∑–∞ —Ü–µ–ª:

- –ü–æ–¥—Å–∏–ª–≤–∞–Ω–µ –Ω–∞ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ DNS –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ç–∞.
- –û–≥—Ä–∞–Ω–∏—á–∞–≤–∞–Ω–µ –Ω–∞ –¥–æ—Å—Ç—ä–ø–∞ –¥–æ –∑–æ–Ω–∏—Ç–µ —á—Ä–µ–∑ ACL –∏ TSIG.
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –ø—Ä–∞–≤–∏–ª–Ω–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ `named.conf.options`.
- –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–∏ –∫–æ–ø–∏—è –ø—Ä–µ–¥–∏ –ø—Ä–æ–º–µ–Ω–∏.
- –¢–µ—Å—Ç–≤–∞–Ω–µ –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—ä–∑—Å—Ç–∞–Ω–æ–≤—è–≤–∞–Ω–µ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º.

---

## ‚úÖ –û—Å–Ω–æ–≤–Ω–∏ —Ü–µ–ª–∏
- –ê–∫—Ç–∏–≤–∏—Ä–∞–Ω–µ –Ω–∞ **TSIG –∫–ª—é—á–æ–≤–µ** –∑–∞ –∑–∞—â–∏—Ç–∞ –ø—Ä–∏ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä –Ω–∞ –∑–æ–Ω–∏.
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ **ACL (Access Control Lists)** –∑–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏ IP.
- –ü–æ—Ç–≤—ä—Ä–∂–¥–µ–Ω–∏–µ, —á–µ `recursion no;` –µ –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω.
- –û–≥—Ä–∞–Ω–∏—á–∞–≤–∞–Ω–µ –Ω–∞ `allow-transfer` –∏ `allow-notify` –¥–æ –¥–æ–≤–µ—Ä–µ–Ω–∏ IP.
- –¢–µ—Å—Ç –∑–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç –Ω–∞ –∑–æ–Ω–∏—Ç–µ —Å–ª–µ–¥ –ø—Ä–æ–º–µ–Ω–∏.
- –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ –ø–æ–¥—Ä–æ–±–µ–Ω —Ñ–∏–Ω–∞–ª–µ–Ω –æ—Ç—á–µ—Ç.

---

## üì• –ö–∞–∫ –¥–∞ –∏–∑—Ç–µ–≥–ª–∏—Ç–µ –∏ —Å—Ç–∞—Ä—Ç–∏—Ä–∞—Ç–µ —Å–∫—Ä–∏–ø—Ç–∞
–°–∫—Ä–∏–ø—Ç—ä—Ç —Å–µ –Ω–∞–º–∏—Ä–∞ –≤ **—á–∞—Å—Ç–Ω–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ** –≤ GitHub –∏ –∏–∑–∏—Å–∫–≤–∞ —Ç–æ–∫–µ–Ω —Å –ø—Ä–∞–≤–∞ –∑–∞ —á–µ—Ç–µ–Ω–µ:

```bash
# 1. –ò–∑—Ç–µ–≥–ª—è–Ω–µ –Ω–∞ —Å–∫—Ä–∏–ø—Ç–∞ —Å GitHub —Ç–æ–∫–µ–Ω
curl -H "Authorization: token <–í–ê–®–ò–Ø_–¢–û–ö–ï–ù>" \
     -fsSL https://raw.githubusercontent.com/NetGalaxySoft/servers/main/set-dns/vps-dns-secure.sh \
     -o vps-dns-secure.sh

# 2. –î–∞–≤–∞–Ω–µ –Ω–∞ –ø—Ä–∞–≤–∞ –∑–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ
chmod +x vps-dns-secure.sh

# 3. –°—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ —Å–∫—Ä–∏–ø—Ç–∞
./vps-dns-secure.sh
```

> üîê **–ë–µ–ª–µ–∂–∫–∞:** –ù–∏–∫–æ–≥–∞ –Ω–µ —Å–ø–æ–¥–µ–ª—è–π—Ç–µ —Å–≤–æ—è GitHub —Ç–æ–∫–µ–Ω –ø—É–±–ª–∏—á–Ω–æ.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ –º–æ–¥—É–ª–∏ –≤ `vps-dns-secure.sh`

---

## –ú–æ–¥—É–ª 1: –ü–†–ï–î–í–ê–†–ò–¢–ï–õ–ù–ò –ü–†–û–í–ï–†–ö–ò

–ú–æ–¥—É–ª 1 –∏–∑–≤—ä—Ä—à–≤–∞ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏, –ø—Ä–µ–¥–∏ –¥–∞ –∑–∞–ø–æ—á–Ω–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞ –∑–∞ DNS —Å–∏–≥—É—Ä–Ω–æ—Å—Ç. –¶–µ–ª—Ç–∞ –µ –¥–∞ —Å–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–∞, —á–µ —Å–∏—Å—Ç–µ–º–∞—Ç–∞ –µ –ø—Ä–∞–≤–∏–ª–Ω–æ –ø–æ–¥–≥–æ—Ç–≤–µ–Ω–∞ –∏ –Ω—è–º–∞ —Ä–∏—Å–∫ –æ—Ç —Ñ–∞—Ç–∞–ª–Ω–∏ –≥—Ä–µ—à–∫–∏.

### ‚úÖ –ö–∞–∫–≤–æ –≤–∫–ª—é—á–≤–∞ –º–æ–¥—É–ª—ä—Ç:

#### **–°–µ–∫—Ü–∏—è 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –±–∞–∑–æ–≤–∞ DNS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**
- –ü—Ä–æ–≤–µ—Ä—è–≤–∞ –¥–∞–ª–∏ —Ñ–∞–π–ª—ä—Ç `/etc/netgalaxy/setup.env` —Å—ä—â–µ—Å—Ç–≤—É–≤–∞.
- –ü–æ—Ç–≤—ä—Ä–∂–¥–∞–≤–∞, —á–µ –æ—Å–Ω–æ–≤–Ω–∏—è—Ç DNS —Å–∫—Ä–∏–ø—Ç `vps-dns-qsetup.sh` –µ –∑–∞–≤—ä—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ (`SETUP_VPS_DNS_STATUS=‚úÖ`).
- –ê–∫–æ –Ω–µ –µ –∏–∑–ø—ä–ª–Ω–µ–Ω–æ ‚Üí —Å–∫—Ä–∏–ø—Ç—ä—Ç –ø—Ä–µ–∫—Ä–∞—Ç—è–≤–∞ —Ä–∞–±–æ—Ç–∞ –∏ —Å–µ —Å–∞–º–æ–∏–∑—Ç—Ä–∏–≤–∞.

#### **–°–µ–∫—Ü–∏—è 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—Ç–∞ —Å–∏—Å—Ç–µ–º–∞**
- –ß–µ—Ç–µ `/etc/os-release` –∏ –∏–∑–≤–ª–∏—á–∞:
  - **OS_NAME** (Ubuntu –∏–ª–∏ Debian).
  - **OS_VERSION** (–ø–æ–¥–¥—ä—Ä–∂–∞–Ω–∏: Ubuntu 22.04/24.04, Debian 11/12).
- –ê–∫–æ –û–° –µ –Ω–µ–ø–æ–¥–¥—ä—Ä–∂–∞–Ω–∞ ‚Üí —Å–ø–∏—Ä–∞ —Å –≥—Ä–µ—à–∫–∞.

#### **–°–µ–∫—Ü–∏—è 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É–±–ª–∏—á–Ω–∏—è IP –∞–¥—Ä–µ—Å**
- –ò–∑–∏—Å–∫–≤–∞ –≤—ä–≤–µ–∂–¥–∞–Ω–µ –Ω–∞ IP –æ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞.
- –ü—Ä–æ–≤–µ—Ä—è–≤–∞:
  - –§–æ—Ä–º–∞—Ç –Ω–∞ IP (–≤–∞–ª–∏–¥–µ–Ω IPv4).
  - –°—ä–≤–ø–∞–¥–µ–Ω–∏–µ —Å —Ä–µ–∞–ª–Ω–∏—è IP (`curl ifconfig.me`).
- –ê–∫–æ –∏–º–∞ —Ä–∞–∑–º–∏–Ω–∞–≤–∞–Ω–µ ‚Üí –∏–∑–∏—Å–∫–≤–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤—ä–≤–µ–∂–¥–∞–Ω–µ –∏–ª–∏ –ø—Ä–µ–∫—Ä–∞—Ç—è–≤–∞–Ω–µ.

#### **–°–µ–∫—Ü–∏—è 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ hostname**
- –ò–∑–ø–æ–ª–∑–≤–∞ `hostname -f` –∑–∞ –∏–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –ø—ä–ª–Ω–∏—è FQDN.
- –ê–∫–æ FQDN –µ –ø—Ä–∞–∑–µ–Ω ‚Üí –ø—Ä–µ–∫—Ä–∞—Ç—è–≤–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ—Ç–æ.

#### **–°–µ–∫—Ü–∏—è 5: –ó–∞–ø–∏—Å –Ω–∞ –¥–∞–Ω–Ω–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–µ–Ω —Ñ–∞–π–ª**
- –°—ä–∑–¥–∞–≤–∞ –∏–ª–∏ –æ–±–Ω–æ–≤—è–≤–∞ —Ñ–∞–π–ª–∞ `/etc/netgalaxy/todo.modules` —Å—ä—Å —Å—Ç–æ–π–Ω–æ—Å—Ç–∏:
  - `SERVER_IP="..."` (–≤–∞–ª–∏–¥–∏—Ä–∞–Ω–∏—è IP).
  - `SERVER_FQDN="..."` (–∏–∑–≤–ª–µ—á–µ–Ω–∏—è FQDN).
- –û–±–Ω–æ–≤—è–≤–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤ `/etc/netgalaxy/setup.env`:
  ```text
  SECURE_DNS_MODULE1=‚úÖ

---

#### –ö–ª—é—á–æ–≤–∏ –æ—Å–æ–±–µ–Ω–æ—Å—Ç–∏ 
- –°–∫—Ä–∏–ø—Ç—ä—Ç —Å–ø–∏—Ä–∞ –ø—Ä–∏ –≤—Å—è–∫–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞ –≥—Ä–µ—à–∫–∞ (–Ω–µ–ø–æ–¥–¥—ä—Ä–∂–∞–Ω–∞ –û–°, –Ω–µ–≤–∞–ª–∏–¥–µ–Ω IP –∏–ª–∏ –ª–∏–ø—Å–≤–∞—â FQDN).
- –ú–æ–¥—É–ª—ä—Ç –µ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–µ–Ω ‚Äì –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ —Å–µ –ø—Ä–æ–ø—É—Å–∫–∞, –∞–∫–æ –≤–µ—á–µ –µ –º–∞—Ä–∫–∏—Ä–∞–Ω –∫–∞—Ç–æ –∑–∞–≤—ä—Ä—à–µ–Ω.

---

## –ú–æ–¥—É–ª 2: –ü–û–î–°–ò–ì–£–†–Ø–í–ê–ù–ï –ù–ê –ë–ê–ó–û–í–ò –ü–û–õ–ò–¢–ò–ö–ò

–ú–æ–¥—É–ª 2 –ø–æ–¥—Å–∏–≥—É—Ä—è–≤–∞ –æ—Å–Ω–æ–≤–Ω–∏—Ç–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –∑–∞ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–∏—è —Ñ–∞–π–ª `named.conf.options`. –¶–µ–ª—Ç–∞ –µ –¥–∞ —Å–µ –º–∏–Ω–∏–º–∏–∑–∏—Ä–∞—Ç —Ä–∏—Å–∫–æ–≤–µ—Ç–µ –æ—Ç –Ω–µ–æ—Ç–æ—Ä–∏–∑–∏—Ä–∞–Ω–∏ –∑–∞—è–≤–∫–∏ –∏ –ø—Ä–µ—Ö–≤—ä—Ä–ª—è–Ω–µ –Ω–∞ –∑–æ–Ω–∏.

---

### ‚úÖ –ö–∞–∫–≤–æ –≤–∫–ª—é—á–≤–∞ –º–æ–¥—É–ª—ä—Ç:

#### **–°–µ–∫—Ü–∏—è 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –Ω–∞–ª–∏—á–∏–µ—Ç–æ –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–∏—è —Ñ–∞–π–ª**
- –ü–æ—Ç–≤—ä—Ä–∂–¥–∞–≤–∞, —á–µ `/etc/bind/named.conf.options` —Å—ä—â–µ—Å—Ç–≤—É–≤–∞.
- –ê–∫–æ —Ñ–∞–π–ª—ä—Ç –ª–∏–ø—Å–≤–∞ ‚Üí —Å–∫—Ä–∏–ø—Ç—ä—Ç –ø—Ä–µ–∫—Ä–∞—Ç—è–≤–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ—Ç–æ.

---

#### **–°–µ–∫—Ü–∏—è 2: –û–±–Ω–æ–≤—è–≤–∞–Ω–µ –Ω–∞ –ø–æ–ª–∏—Ç–∏–∫–∏ –∑–∞ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç**
- –ü—Ä–µ–º–∞—Ö–≤–∞ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞—â–∏ –¥–∏—Ä–µ–∫—Ç–∏–≤–∏ `recursion`, `allow-transfer`, `allow-recursion`, –∑–∞ –¥–∞ –∏–∑–±–µ–≥–Ω–µ –¥—É–±–ª–∏—Ä–∞–Ω–µ.
- –î–æ–±–∞–≤—è —Å–ª–µ–¥–Ω–∏—Ç–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –≤—ä—Ç—Ä–µ –≤ –±–ª–æ–∫–∞ `options { ... };`:
  ```text
  recursion no;
  allow-transfer { none; };
  dnssec-validation auto;

–ì–∞—Ä–∞–Ω—Ç–∏—Ä–∞, —á–µ:
- **recursion** –µ –∏–∑–∫–ª—é—á–µ–Ω (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç—è–≤–∞ –Ω–µ–æ—Ç–æ—Ä–∏–∑–∏—Ä–∞–Ω–∏ –∑–∞—è–≤–∫–∏),
- **–∑–æ–Ω–µ–Ω —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä** –µ –∑–∞–±—Ä–∞–Ω–µ–Ω –ø–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ,
- **DNSSEC** –µ –∞–∫—Ç–∏–≤–µ–Ω –∑–∞ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∞ –∑–∞—â–∏—Ç–∞.

---

### **–°–µ–∫—Ü–∏—è 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞**
- –°—Ç–∞—Ä—Ç–∏—Ä–∞ `named-checkconf` –∑–∞ –≤–∞–ª–∏–¥–∏—Ä–∞–Ω–µ –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞.
- –ê–∫–æ –∏–º–∞ –≥—Ä–µ—à–∫–∞ ‚Üí –ø–æ–∫–∞–∑–≤–∞ —Å—ä–æ–±—â–µ–Ω–∏–µ –∏ –ø—Ä–µ–∫—Ä–∞—Ç—è–≤–∞ —Å–∫—Ä–∏–ø—Ç–∞.

---

### **–°–µ–∫—Ü–∏—è 4: –†–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ Bind9**
- –†–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞ —É—Å–ª—É–≥–∞—Ç–∞ `bind9` —á—Ä–µ–∑ `systemctl`.
- –ü—Ä–æ–≤–µ—Ä—è–≤–∞ –¥–∞–ª–∏ –µ –∞–∫—Ç–∏–≤–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∏.
- –ü—Ä–∏ –Ω–µ—É—Å–ø–µ—Ö ‚Üí –ø—Ä–µ–∫—Ä–∞—Ç—è–≤–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ—Ç–æ.

---

### **–°–µ–∫—Ü–∏—è 5: –ó–∞–ø–∏—Å –Ω–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞**
- –û–±–Ω–æ–≤—è–≤–∞ –∏–ª–∏ –¥–æ–±–∞–≤—è –≤ `/etc/netgalaxy/setup.env`:
  ```text
  SECURE_DNS_MODULE2=‚úÖ

---

### üîê –ö–ª—é—á–æ–≤–∏ –æ—Å–æ–±–µ–Ω–æ—Å—Ç–∏
- **–ò–∑–∫–ª—é—á–≤–∞–Ω–µ –Ω–∞ —Ä–µ–∫—É—Ä—Å–∏—è—Ç–∞** (–∑–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç—è–≤–∞–Ω–µ –Ω–∞ open resolver –∞—Ç–∞–∫–∏).
- **–ó–∞–±—Ä–∞–Ω–∞ –Ω–∞ –∑–æ–Ω–µ–Ω —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä** –ø–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ.
- **–ê–∫—Ç–∏–≤–∏—Ä–∞–Ω–µ –Ω–∞ DNSSEC** –≤–∞–ª–∏–¥–∞—Ü–∏—è.
- **–ú–æ–¥—É–ª—ä—Ç –µ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–µ–Ω** ‚Äì –ø–æ–≤—Ç–æ—Ä–Ω–æ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–µ –≤–æ–¥–∏ –¥–æ –¥—É–±–ª–∏—Ä–∞–Ω–µ –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞.

---

## –ú–æ–¥—É–ª 3: ACL –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ IP

–ú–æ–¥—É–ª 3 –¥–æ–±–∞–≤—è –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–∞–Ω–∏ —Å–ø–∏—Å—ä—Ü–∏ –∑–∞ –¥–æ—Å—Ç—ä–ø (ACL) –∏ –ø–æ–ª–∏—Ç–∏–∫–∏ –∑–∞ –æ–≥—Ä–∞–Ω–∏—á–∞–≤–∞–Ω–µ –Ω–∞ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∏—Ç–µ –Ω–∞ DNS –∑–æ–Ω–∏. –¶–µ–ª—Ç–∞ –µ –¥–∞ —Å–µ –ø–æ–∑–≤–æ–ª–∏ –∑–æ–Ω–µ–Ω —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä –∏ –∏–∑–≤–µ—Å—Ç—è–≤–∞–Ω–µ (notify) —Å–∞–º–æ –∑–∞ –¥–æ–≤–µ—Ä–µ–Ω–∏ —Å—ä—Ä–≤—ä—Ä–∏, –º–∏–Ω–∏–º–∏–∑–∏—Ä–∞–π–∫–∏ —Ä–∏—Å–∫–∞ –æ—Ç –Ω–µ–æ—Ç–æ—Ä–∏–∑–∏—Ä–∞–Ω–∏ –∑–∞—è–≤–∫–∏.

---

### ‚úÖ –ö–∞–∫–≤–æ –≤–∫–ª—é—á–≤–∞ –º–æ–¥—É–ª—ä—Ç:

#### **–°–µ–∫—Ü–∏—è 1: –ò–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏**
- –ó–∞—Ä–µ–∂–¥–∞ –æ—Å–Ω–æ–≤–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏:
  - **SERVER_IP** ‚Äì —Ç–µ–∫—É—â–∏—è—Ç IP –Ω–∞ —Å—ä—Ä–≤—ä—Ä–∞ (—á—Ä–µ–∑ `hostname -I`).
  - **SERVER_FQDN** ‚Äì –ø—ä–ª–Ω–æ—Ç–æ –∏–º–µ –Ω–∞ —Ö–æ—Å—Ç–∞ (–æ—Ç `todo.modules` –∏–ª–∏ `hostname -f`).
  - **DNS_ROLE** ‚Äì —Ä–æ–ª—è (primary/secondary), –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –æ—Ç –∏–º–µ—Ç–æ –∏–ª–∏ `todo.modules`.
  - **SECOND_DNS_IP** ‚Äì IP –∞–¥—Ä–µ—Å—ä—Ç –Ω–∞ –≤—Ç–æ—Ä–∏—è DNS —Å—ä—Ä–≤—ä—Ä (—á—Ä–µ–∑ DNS lookup).
- –í–∞–ª–∏–¥–∏—Ä–∞ IP –∞–¥—Ä–µ—Å–∏—Ç–µ, –∑–∞ –¥–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–∞ –∫–æ—Ä–µ–∫—Ç–Ω–æ—Å—Ç.

---

#### **–°–µ–∫—Ü–∏—è 2: –î–æ–±–∞–≤—è–Ω–µ –Ω–∞ ACL –∏ –ø–æ–ª–∏—Ç–∏–∫–∏**
- –°—ä–∑–¥–∞–≤–∞ ACL –±–ª–æ–∫:
  ```text
  acl "trusted" {
      SERVER_IP;
      SECOND_DNS_IP;
  };
  ```
- –î–æ–±–∞–≤—è –¥–∏—Ä–µ–∫—Ç–∏–≤–∏ –≤ `named.conf.options`:
  ```text
  allow-transfer { trusted; };
  also-notify { SECOND_DNS_IP; };  # —Å–∞–º–æ –ø—Ä–∏ primary —Ä–æ–ª—è
  ```

---

#### **–°–µ–∫—Ü–∏—è 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Ä–µ—Å—Ç–∞—Ä—Ç**
- –ü—Ä–æ–≤–µ—Ä—è–≤–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞:
  ```bash
  named-checkconf
  ```
- –ü—Ä–∏ –≥—Ä–µ—à–∫–∞ ‚Üí –ø—Ä–µ–∫—Ä–∞—Ç—è–≤–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ—Ç–æ.
- –†–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞ Bind9 –∏ –≤–∞–ª–∏–¥–∏—Ä–∞ –¥–∞–ª–∏ —É—Å–ª—É–≥–∞—Ç–∞ –µ –∞–∫—Ç–∏–≤–Ω–∞.

---

#### **–°–µ–∫—Ü–∏—è 4: –ó–∞–ø–∏—Å –≤ todo.modules**
- –ó–∞–ø–∏—Å–≤–∞/–æ–±–Ω–æ–≤—è–≤–∞:
  ```text
  SERVER_IP="..."
  SECOND_DNS_IP="..."
  SERVER_FQDN="..."
  DNS_ROLE="..."
  ```

---

#### **–°–µ–∫—Ü–∏—è 5: –ó–∞–ø–∏—Å –Ω–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç**
- –î–æ–±–∞–≤—è –∏–ª–∏ –æ–±–Ω–æ–≤—è–≤–∞ –≤ `/etc/netgalaxy/setup.env`:
  ```text
  SECURE_DNS_MODULE3=‚úÖ
  ```

---

### üîê –ö–ª—é—á–æ–≤–∏ –æ—Å–æ–±–µ–Ω–æ—Å—Ç–∏:
- –ò–∑–ø–æ–ª–∑–≤–∞ ACL –∑–∞ –æ–≥—Ä–∞–Ω–∏—á–∞–≤–∞–Ω–µ –Ω–∞ –∑–æ–Ω–µ–Ω —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä.
- –ü—Ä–∏ primary —Ä–æ–ª—è –¥–æ–±–∞–≤—è **also-notify** –∑–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —É–≤–µ–¥–æ–º—è–≤–∞–Ω–µ –Ω–∞ secondary.
- –ú–æ–¥—É–ª—ä—Ç –µ **–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–µ–Ω** ‚Äì –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ –Ω–µ –≤–æ–¥–∏ –¥–æ –¥—É–±–ª–∏—Ä–∞–Ω–µ.

---

## –ú–æ–¥—É–ª 4: –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ TSIG –∫–ª—é—á

–ú–æ–¥—É–ª 4 –≥–µ–Ω–µ—Ä–∏—Ä–∞ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—Å–∫–∏ –∫–ª—é—á (TSIG), –∫–æ–π—Ç–æ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –∑–∞ —É–¥–æ—Å—Ç–æ–≤–µ—Ä—è–≤–∞–Ω–µ –Ω–∞ –∑–æ–Ω–µ–Ω —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä –º–µ–∂–¥—É Primary –∏ Secondary DNS —Å—ä—Ä–≤—ä—Ä–∏. –¢–æ–≤–∞ –µ –∫—Ä–∏—Ç–∏—á–Ω–∞ —Å—Ç—ä–ø–∫–∞ –∑–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ–æ—Ç–æ—Ä–∏–∑–∏—Ä–∞–Ω–∏ –∑–∞—è–≤–∫–∏ –∏ –ø–æ–¥–ø—Ä–∞–≤—è–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏.

---

### ‚úÖ –ö–∞–∫–≤–æ –≤–∫–ª—é—á–≤–∞ –º–æ–¥—É–ª—ä—Ç:

#### **–°–µ–∫—Ü–∏—è 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –∑–∞ –∫–ª—é—á–æ–≤–µ**
- –°—ä–∑–¥–∞–≤–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `/etc/bind/keys`, –∞–∫–æ –Ω–µ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞.
- –ó–∞–¥–∞–≤–∞ –ø—Ä–∞–≤–∏–ª–Ω–∏ –ø—Ä–∞–≤–∞ –∏ —Å–æ–±—Å—Ç–≤–µ–Ω–æ—Å—Ç:
  ```bash
  mkdir -p /etc/bind/keys
  chown bind:bind /etc/bind/keys
  chmod 750 /etc/bind/keys
  ```

---

#### **–°–µ–∫—Ü–∏—è 2: –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ TSIG –∫–ª—é—á (hmac-sha256)**
- –ì–µ–Ω–µ—Ä–∏—Ä–∞ –∫–ª—é—á —Å –ø–æ–º–æ—â—Ç–∞ –Ω–∞ `tsig-keygen`:
  ```bash
  tsig-keygen -a hmac-sha256 netgalaxy-key
  ```
- –ó–∞–ø–∏—Å–≤–∞ –∫–ª—é—á–∞ –≤—ä–≤ —Ñ–∞–π–ª:
  ```
  /etc/bind/keys/tsig.key
  ```
- –ó–∞–¥–∞–≤–∞ –ø—Ä–∞–≤–∞:
  ```bash
  chown bind:bind tsig.key
  chmod 640 tsig.key
  ```

---

#### **–°–µ–∫—Ü–∏—è 3: –î–æ–±–∞–≤—è–Ω–µ –Ω–∞ –∫–ª—é—á–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞**
- –í–∫–ª—é—á–≤–∞ –∫–ª—é—á–∞ –≤ `named.conf.local`:
  ```text
  include "/etc/bind/keys/tsig.key";
  ```
- –ü–æ–¥–≥–æ—Ç–≤—è –∑–∞ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞ –Ω–∞ –∑–æ–Ω–∏—Ç–µ (—â–µ —Å–µ –¥–æ–±–∞–≤–∏ –≤ –ø–æ-–∫—ä—Å–µ–Ω –µ—Ç–∞–ø):
  ```text
  server SECOND_DNS_IP {
      keys "netgalaxy-key";
  };
  also-notify { SECOND_DNS_IP; };
  ```

---

#### **–°–µ–∫—Ü–∏—è 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Ä–µ—Å—Ç–∞—Ä—Ç**
- –ü—Ä–æ–≤–µ—Ä—è–≤–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞:
  ```bash
  named-checkconf
  ```
- –ü—Ä–∏ —É—Å–ø–µ—Ö ‚Üí —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞ Bind9:
  ```bash
  systemctl restart bind9
  ```

---

#### **–°–µ–∫—Ü–∏—è 5: –ó–∞–ø–∏—Å –Ω–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞**
- –î–æ–±–∞–≤—è –≤ `/etc/netgalaxy/setup.env`:
  ```text
  SECURE_DNS_MODULE4=‚úÖ
  ```

---

### üîê –ö–ª—é—á–æ–≤–∏ –æ—Å–æ–±–µ–Ω–æ—Å—Ç–∏:
- –ö–ª—é—á—ä—Ç —Å–µ –≥–µ–Ω–µ—Ä–∏—Ä–∞ —Å–∞–º–æ –≤–µ–¥–Ω—ä–∂ –∏ —Å–µ –ø–∞–∑–∏ –≤ –∑–∞—â–∏—Ç–µ–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è.
- –ü–æ–ª–∑–≤–∞ —Å–µ –∞–ª–≥–æ—Ä–∏—Ç—ä–º **HMAC-SHA256** –∑–∞ —Å–∏–ª–Ω–∞ –∑–∞—â–∏—Ç–∞.
- –ú–æ–¥—É–ª—ä—Ç –µ **–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–µ–Ω** ‚Äì –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ –Ω–µ –ø—Ä–æ–º–µ–Ω—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞, –∞–∫–æ –≤–µ—á–µ –µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞.

---

## –ú–æ–¥—É–ª 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Ä–µ—Å—Ç–∞—Ä—Ç

–ú–æ–¥—É–ª 5 –∏–∑–≤—ä—Ä—à–≤–∞ –ø—ä–ª–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞ –Ω–∞ **Bind9** –∏ –æ—Å–∏–≥—É—Ä—è–≤–∞, —á–µ —É—Å–ª—É–≥–∞—Ç–∞ –µ –≤ —Ä–∞–±–æ—Ç–Ω–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ —Å–ª–µ–¥ –ø—Ä–æ–º–µ–Ω–∏—Ç–µ, –Ω–∞–ø—Ä–∞–≤–µ–Ω–∏ –≤ –ø—Ä–µ–¥–∏—à–Ω–∏—Ç–µ –º–æ–¥—É–ª–∏.

---

### ‚úÖ –ö–∞–∫–≤–æ –≤–∫–ª—é—á–≤–∞ –º–æ–¥—É–ª—ä—Ç:

#### **–°–µ–∫—Ü–∏—è 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞**
- –°—Ç–∞—Ä—Ç–∏—Ä–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å:
  ```bash
  named-checkconf
  ```
- –ê–∫–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞ —Å—ä–¥—ä—Ä–∂–∞ –≥—Ä–µ—à–∫–∏ ‚Üí –ø–æ–∫–∞–∑–≤–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∏ —Å–ø–∏—Ä–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ—Ç–æ.

---

#### **–°–µ–∫—Ü–∏—è 2: –†–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ Bind9**
- –ò–∑–≤—ä—Ä—à–≤–∞ —Ä–µ—Å—Ç–∞—Ä—Ç –Ω–∞ —É—Å–ª—É–≥–∞—Ç–∞:
  ```bash
  systemctl restart bind9
  ```
- –ü—Ä–∏ –Ω–µ—É—Å–ø–µ—Ö ‚Üí –ø—Ä–µ–∫—Ä–∞—Ç—è–≤–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ—Ç–æ —Å –≥—Ä–µ—à–∫–∞.

---

#### **–°–µ–∫—Ü–∏—è 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–∞—Ç—É—Å–∞**
- –£–≤–µ—Ä—è–≤–∞ —Å–µ, —á–µ Bind9 –µ –∞–∫—Ç–∏–≤–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∏:
  ```bash
  systemctl is-active --quiet bind9
  ```
- –ê–∫–æ —É—Å–ª—É–≥–∞—Ç–∞ –Ω–µ –µ –∞–∫—Ç–∏–≤–Ω–∞ ‚Üí –ø–æ–∫–∞–∑–≤–∞ —Å—ä–æ–±—â–µ–Ω–∏–µ –∑–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞ –≥—Ä–µ—à–∫–∞.

---

#### **–°–µ–∫—Ü–∏—è 4: –ó–∞–ø–∏—Å –Ω–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞**
- –î–æ–±–∞–≤—è –∏–ª–∏ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞ –≤ `/etc/netgalaxy/setup.env`:
  ```text
  SECURE_DNS_MODULE5=‚úÖ
  ```

---

### üîê –ö–ª—é—á–æ–≤–∏ –æ—Å–æ–±–µ–Ω–æ—Å—Ç–∏:
- –ü—Ä–æ–≤–µ—Ä—è–≤–∞ —Ü–µ–ª–æ—Å—Ç—Ç–∞ –Ω–∞ –≤—Å–∏—á–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–µ–¥–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–∞.
- –†–µ—Å—Ç–∞—Ä—Ç—ä—Ç –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–µ–Ω –∑–∞ –ø—Ä–∏–ª–∞–≥–∞–Ω–µ –Ω–∞ –Ω–æ–≤–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–∞, —á–µ —É—Å–ª—É–≥–∞—Ç–∞ Bind9 –µ —Å—Ç–∞–±–∏–ª–Ω–∞ –∏ –∞–∫—Ç–∏–≤–Ω–∞.
- **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–µ–Ω** ‚Äì –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ –Ω—è–º–∞ –¥–∞ –ø—Ä–µ–¥–∏–∑–≤–∏–∫–∞ –¥—É–±–ª–∏—Ä–∞–Ω–µ –∏–ª–∏ –≥—Ä–µ—à–∫–∏.

---

## –ú–æ–¥—É–ª 6: –¢–µ—Å—Ç –Ω–∞ TSIG

–ú–æ–¥—É–ª 6 –ø—Ä–æ–≤–µ—Ä—è–≤–∞ –∫–æ—Ä–µ–∫—Ç–Ω–∞—Ç–∞ —Ä–∞–±–æ—Ç–∞ –Ω–∞ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –∑–∞ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç —Å TSIG –∫–ª—é—á–æ–≤–µ, –∫–∞—Ç–æ —Ç–µ—Å—Ç–≤–∞ –∑–æ–Ω–µ–Ω —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä (**AXFR**) –º–µ–∂–¥—É primary –∏ secondary DNS —Å—ä—Ä–≤—ä—Ä–∏—Ç–µ.

---

### ‚úÖ –ö–∞–∫–≤–æ –≤–∫–ª—é—á–≤–∞ –º–æ–¥—É–ª—ä—Ç:

#### **–°–µ–∫—Ü–∏—è 1: –ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω–∏ –¥–∞–Ω–Ω–∏**
- –ß–µ—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –æ—Ç `/etc/netgalaxy/todo.modules`:
  - `SERVER_FQDN` ‚Äì –ø—ä–ª–Ω–æ –∏–º–µ –Ω–∞ —Å—ä—Ä–≤—ä—Ä–∞.
  - `DNS_ROLE` ‚Äì —Ä–æ–ª—è –Ω–∞ —Å—ä—Ä–≤—ä—Ä–∞ (primary/secondary).
  - `SECOND_DNS_IP` ‚Äì IP –∞–¥—Ä–µ—Å –Ω–∞ –¥—Ä—É–≥–∏—è DNS —Å—ä—Ä–≤—ä—Ä.
- –ü—Ä–æ–≤–µ—Ä—è–≤–∞ –¥–∞–ª–∏ —Å–∞ –Ω–∞–ª–∏—á–Ω–∏ –≤—Å–∏—á–∫–∏ –¥–∞–Ω–Ω–∏.
- –ê–∫–æ –ª–∏–ø—Å–≤–∞—Ç ‚Üí –ø–æ–∫–∞–∑–≤–∞ –≥—Ä–µ—à–∫–∞ –∏ –ø—Ä–µ–∫—Ä–∞—Ç—è–≤–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ—Ç–æ.

---

#### **–°–µ–∫—Ü–∏—è 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ TSIG –∫–ª—é—á**
- –ü–æ—Ç–≤—ä—Ä–∂–¥–∞–≤–∞, —á–µ —Ñ–∞–π–ª—ä—Ç —Å –∫–ª—é—á–∞ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞:
  ```bash
  /etc/bind/keys/tsig.key
  ```
- –ê–∫–æ –ª–∏–ø—Å–≤–∞ ‚Üí –ø–æ–∫–∞–∑–≤–∞ —Å—ä–æ–±—â–µ–Ω–∏–µ –∑–∞ –≥—Ä–µ—à–∫–∞ –∏ —Å–ø–∏—Ä–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ—Ç–æ.

---

#### **–°–µ–∫—Ü–∏—è 3: –ò–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –∏–º–µ—Ç–æ –Ω–∞ –∫–ª—é—á–∞**
- –ß–µ—Ç–µ –∏–º–µ—Ç–æ –Ω–∞ –∫–ª—é—á–∞ –æ—Ç —Ñ–∞–π–ª–∞ `tsig.key`.
- –ò–∑–ø–æ–ª–∑–≤–∞ —Ç–æ–≤–∞ –∏–º–µ –ø—Ä–∏ —Ç–µ—Å—Ç–∞ –Ω–∞ –∑–æ–Ω–µ–Ω —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä.

---

#### **–°–µ–∫—Ü–∏—è 4: –¢–µ—Å—Ç –Ω–∞ –∑–æ–Ω–µ–Ω —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä**
- –°—Ç–∞—Ä—Ç–∏—Ä–∞ —Ç–µ—Å—Ç–æ–≤–∞ –∑–∞—è–≤–∫–∞:
  ```bash
  dig @SECOND_DNS_IP DOMAIN AXFR -y "–∫–ª—é—á"
  ```
- –ü—Ä–æ–≤–µ—Ä—è–≤–∞ –∏–∑—Ö–æ–¥–∞:
  - –ê–∫–æ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—ä—Ç –µ —É—Å–ø–µ—à–µ–Ω ‚Üí –∏–∑–≤–µ–∂–¥–∞ –ø–æ—Ç–≤—ä—Ä–∂–¥–µ–Ω–∏–µ.
  - –ê–∫–æ –Ω–µ ‚Üí –ø–æ–∫–∞–∑–≤–∞ —Å—ä–æ–±—â–µ–Ω–∏–µ –∑–∞ –≥—Ä–µ—à–∫–∞.

---

#### **–°–µ–∫—Ü–∏—è 5: –ó–∞–ø–∏—Å –Ω–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç**
- –û–±–Ω–æ–≤—è–≤–∞ –∏–ª–∏ –¥–æ–±–∞–≤—è –≤ `/etc/netgalaxy/setup.env`:
  ```text
  SECURE_DNS_MODULE6=‚úÖ
  ```

---

### üîê –ö–ª—é—á–æ–≤–∏ –æ—Å–æ–±–µ–Ω–æ—Å—Ç–∏:
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–∞, —á–µ –¥–≤–∞—Ç–∞ DNS —Å—ä—Ä–≤—ä—Ä–∞ —Å–∞ –ø—Ä–∞–≤–∏–ª–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–∞–Ω–∏.
- –ü–æ—Ç–≤—ä—Ä–∂–¥–∞–≤–∞, —á–µ TSIG –∫–ª—é—á—ä—Ç –µ –∞–∫—Ç–∏–≤–µ–Ω –∏ –∏–∑–ø–æ–ª–∑–≤–∞–µ–º –∑–∞ —Å–∏–≥—É—Ä–µ–Ω –∑–æ–Ω–µ–Ω —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä.
- **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–µ–Ω** ‚Äì –ø–æ–≤—Ç–æ—Ä–Ω–æ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–µ –ø—Ä–æ–º–µ–Ω—è —É—Å–ø–µ—à–Ω–∞—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è.

---

## –ú–æ–¥—É–ª 7: –§–∏–Ω–∞–ª–µ–Ω –æ—Ç—á–µ—Ç

–ú–æ–¥—É–ª 7 –æ–±–æ–±—â–∞–≤–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏—Ç–µ –æ—Ç –≤—Å–∏—á–∫–∏ –ø—Ä–µ–¥–∏—à–Ω–∏ –º–æ–¥—É–ª–∏ –∏ –º–∞—Ä–∫–∏—Ä–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞ –∫–∞—Ç–æ –∑–∞–≤—ä—Ä—à–µ–Ω–∞, –∞–∫–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ä—Ç —è –ø–æ—Ç–≤—ä—Ä–¥–∏.

---

### ‚úÖ –ö–∞–∫–≤–æ –≤–∫–ª—é—á–≤–∞ –º–æ–¥—É–ª—ä—Ç:

#### **–°–µ–∫—Ü–∏—è 1: –ü–æ–∫–∞–∑–≤–∞–Ω–µ –Ω–∞ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ –≤—Å–∏—á–∫–∏ –º–æ–¥—É–ª–∏**
- –ß–µ—Ç–µ —Å—Ç–∞—Ç—É—Å–∏—Ç–µ –æ—Ç `/etc/netgalaxy/setup.env` –∑–∞:
  - `SECURE_DNS_MODULE1` ‚Äì –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª–Ω–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
  - `SECURE_DNS_MODULE2` ‚Äì –ë–∞–∑–æ–≤–∏ –ø–æ–ª–∏—Ç–∏–∫–∏
  - `SECURE_DNS_MODULE3` ‚Äì ACL –∏ IP –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
  - `SECURE_DNS_MODULE4` ‚Äì TSIG –∫–ª—é—á
  - `SECURE_DNS_MODULE5` ‚Äì –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Ä–µ—Å—Ç–∞—Ä—Ç
  - `SECURE_DNS_MODULE6` ‚Äì –¢–µ—Å—Ç –Ω–∞ TSIG
- –ò–∑–≤–µ–∂–¥–∞ –æ—Ç—á–µ—Ç –≤—ä–≤ —Ñ–æ—Ä–º–∞—Ç:
  ```text
  üìå –ú–æ–¥—É–ª 1 ‚Äì ‚úÖ / ‚ùå
  üìå –ú–æ–¥—É–ª 2 ‚Äì ‚úÖ / ‚ùå
  ...
  ```

---

#### **–°–µ–∫—Ü–∏—è 2: –ü–æ—Ç–≤—ä—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞**
- –ü–∏—Ç–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞:
  ```text
  ‚úÖ –ü—Ä–∏–µ–º–∞—Ç–µ –ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞ –∫–∞—Ç–æ —É—Å–ø–µ—à–Ω–∞? (y/n):
  ```
- –ü—Ä–∏ –æ—Ç–≥–æ–≤–æ—Ä **y**:
  - –ó–∞–ø–∏—Å–≤–∞:
    ```text
    SETUP_SECURE_DNS_STATUS=‚úÖ
    SECURE_DNS_MODULE7=‚úÖ
    ```
    –≤ `/etc/netgalaxy/setup.env`.
  - –ò–∑—Ç—Ä–∏–≤–∞ –≤—Ä–µ–º–µ–Ω–Ω–∏—è —Ñ–∞–π–ª:
    ```text
    /etc/netgalaxy/todo.modules
    ```
  - –ò–∑—Ç—Ä–∏–≤–∞ —Å–∫—Ä–∏–ø—Ç–∞:
    ```text
    rm -- "$0"
    ```

- –ü—Ä–∏ –æ—Ç–≥–æ–≤–æ—Ä **n**:
  - –ù–µ –ø—Ä–∞–≤–∏ –ø—Ä–æ–º–µ–Ω–∏ –∏ –Ω–µ –∏–∑—Ç—Ä–∏–≤–∞ —Ñ–∞–π–ª–æ–≤–µ.

---

### üîê –ö–ª—é—á–æ–≤–∏ –æ—Å–æ–±–µ–Ω–æ—Å—Ç–∏:
- –û–±–æ–±—â–∞–≤–∞ —Ü–µ–ª–∏—è –ø—Ä–æ—Ü–µ—Å –ø—Ä–µ–¥–∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è.
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–∞, —á–µ —Å–ª–µ–¥ –ø–æ—Ç–≤—ä—Ä–∂–¥–µ–Ω–∏–µ –Ω—è–º–∞ –¥–∞ –∏–º–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ —Å–∫—Ä–∏–ø—Ç–∞.
- –ü—Ä–µ–º–∞—Ö–≤–∞ –≤—Ä–µ–º–µ–Ω–Ω–∏ –¥–∞–Ω–Ω–∏ –∑–∞ —á–∏—Å—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ —Å–ª–µ–¥ –∑–∞–≤—ä—Ä—à–≤–∞–Ω–µ.

---

## ‚úÖ –î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏ –º–µ—Ä–∫–∏ (–ø–ª–∞–Ω–∏—Ä–∞–Ω–∏)
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å fail2ban** –∑–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç brute-force –∞—Ç–∞–∫–∏.
- **–õ–∏–º–∏—Ç–∏—Ä–∞–Ω–µ –Ω–∞ —á–µ—Å—Ç–æ—Ç–∞ –Ω–∞ –æ—Ç–≥–æ–≤–æ—Ä–∏—Ç–µ (rate limiting)** –∑–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç—è–≤–∞–Ω–µ –Ω–∞ DoS –∞—Ç–∞–∫–∏.
- **–í–æ–¥–µ–Ω–µ –Ω–∞ audit log** –∑–∞ –≤—Å–∏—á–∫–∏ –ø—Ä–æ–º–µ–Ω–∏ –ø–æ DNS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞.

---

## üîç –ü—Ä–µ–¥–∏–º—Å—Ç–≤–∞ –Ω–∞ –ø–æ–¥—Ö–æ–¥–∞
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** ‚Äì –≤—Å–∏—á–∫–∏ —Å—Ç—ä–ø–∫–∏ —Å–µ –∏–∑–ø—ä–ª–Ω—è–≤–∞—Ç –±–µ–∑ —Ä—ä—á–Ω–∞ –Ω–∞–º–µ—Å–∞.
- **–°—ä–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç** ‚Äì –≥–∞—Ä–∞–Ω—Ç–∏—Ä–∞ —Ä–∞–±–æ—Ç–∞ —Å –ø—Ä–µ–¥–∏—à–Ω–∏—è —Å–∫—Ä–∏–ø—Ç [`vps-dns-qsetup.sh`](#).
- **–°–∏–≥—É—Ä–Ω–æ—Å—Ç –Ω–∞ –≤–∏—Å–æ–∫–æ –Ω–∏–≤–æ** ‚Äì –∫–æ–º–±–∏–Ω–∏—Ä–∞ ACL, TSIG –∏ –≤–∞–ª–∏–¥–∏—Ä–∞–Ω–µ –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ç–∞.

---
